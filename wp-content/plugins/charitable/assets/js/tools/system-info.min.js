const CharitableSystemInfo=window.CharitableSystemInfo||function(e,a,t){const i={init(){t(i.ready)},ready(){i.events()},events(){t(e).on("click","#charitable-system-information-copy",function(e){e.preventDefault(),i.copySystemInformation()}),t(e).on("click","#charitable-ssl-verify",function(e){e.preventDefault(),i.verifySSLConnection()}),t(e).on("click","#charitable-email-diagnostics",function(e){e.preventDefault(),i.runEmailDiagnostics()}),t(e).on("click","#charitable-send-test-email",function(e){e.preventDefault(),i.sendTestEmail()}),t(e).on("click","#charitable-email-diagnostics-copy",function(e){e.preventDefault(),i.copyEmailDiagnostics()})},copySystemInformation(){t("#charitable-system-information").select(),e.execCommand("copy")},verifySSLConnection(){const e=t("#charitable-ssl-verify"),a=e.text(),i=e.outerWidth(),s=e.parent();if("undefined"!=typeof charitable_admin_tools&&void 0!==charitable_admin_tools.ajax_url&&void 0!==charitable_admin_tools.nonce&&void 0!==charitable_admin_tools.testing){e.css("width",i).prop("disabled",!0).text(charitable_admin_tools.testing);const c={action:"charitable_verify_ssl",nonce:charitable_admin_tools.nonce};t.post(charitable_admin_tools.ajax_url,c,function(t){"undefined"!=typeof wpchar&&wpchar.debug(t),s.find(".charitable-notice").remove(),t.success&&e.before('<div class="notice charitable-notice notice-success">'+t.data.msg+"</div>"),!t.success&&t.data.msg&&e.before('<div class="notice charitable-notice notice-error">'+t.data.msg+"</div>"),!t.success&&t.data.debug&&e.before('<div class="charitable-ssl-error pre-error">'+t.data.debug+"</div>"),e.css("width",i).prop("disabled",!1).text(a)})}},runEmailDiagnostics(){const e=t("#charitable-email-diagnostics"),a=t("#charitable-email-diagnostics-results"),i=a.find("textarea"),s=t("#charitable-email-diagnostics-copy"),c=e.text(),n=e.outerWidth();if("undefined"!=typeof charitable_email_diagnostics){e.css("width",n).prop("disabled",!0).text(charitable_email_diagnostics.running_text),a.show(),i.val("Running diagnostics, please wait..."),s.hide(),e.parent().find(".charitable-notice").remove();const o={action:"charitable_email_diagnostics",nonce:charitable_email_diagnostics.nonce};t.post(charitable_email_diagnostics.ajax_url,o,function(a){if("undefined"!=typeof wpchar&&wpchar.debug(a),a.success&&a.data.diagnostics)i.val(a.data.diagnostics),s.show(),e.before('<div class="notice charitable-notice notice-success"><p>Email diagnostics completed successfully.</p></div>');else{let t=charitable_email_diagnostics.error_text;a.data&&a.data.message&&(t=a.data.message),i.val("### DIAGNOSTIC ERROR ###\n\n"+t),e.before('<div class="notice charitable-notice notice-error"><p>'+t+"</p></div>")}e.css("width",n).prop("disabled",!1).text(c)}).fail(function(a,t,s){const o="AJAX request failed: "+t+" - "+s;i.val("### DIAGNOSTIC ERROR ###\n\n"+o),e.before('<div class="notice charitable-notice notice-error"><p>Diagnostics request failed. Please try again.</p></div>'),e.css("width",n).prop("disabled",!1).text(c),"undefined"!=typeof wpchar&&wpchar.debug({xhr:a,status:t,error:s})})}else e.before('<div class="notice charitable-notice notice-error"><p>Email diagnostics not properly loaded. Please refresh the page and try again.</p></div>')},sendTestEmail(){const e=t("#charitable-send-test-email"),a=t("#charitable-test-email-message"),i=t("#charitable-test-email-message-text"),s=e.text();if("undefined"!=typeof charitable_email_diagnostics){e.prop("disabled",!0).text(charitable_email_diagnostics.sending_text||"Sending..."),a.hide(),e.parent().find(".charitable-notice").not("#charitable-test-email-message .charitable-notice").remove();const c={action:"charitable_send_test_email",nonce:charitable_email_diagnostics.test_email_nonce};t.post(charitable_email_diagnostics.ajax_url,c,function(t){if("undefined"!=typeof wpchar&&wpchar.debug(t),t.success&&t.data.success)i.text(t.data.message),a.find(".charitable-notice").removeClass("notice-error").addClass("notice-success"),a.show();else{let e="Test email failed to send.";t.data&&t.data.message&&(e=t.data.message),i.text(e),a.find(".charitable-notice").removeClass("notice-success").addClass("notice-error"),a.show()}e.prop("disabled",!1).text(s)}).fail(function(t,c,n){i.text("Test email request failed. Please try again. If problems persist, contact support."),a.find(".charitable-notice").removeClass("notice-success").addClass("notice-error"),a.show(),e.prop("disabled",!1).text(s),"undefined"!=typeof wpchar&&wpchar.debug({xhr:t,status:c,error:n})})}else i.text("Test email functionality not properly loaded. Please refresh the page and try again."),a.find(".charitable-notice").removeClass("notice-success").addClass("notice-error"),a.show()},copyEmailDiagnostics(){const a=t("#charitable-email-diagnostics-results textarea");if(a.length){a.select(),e.execCommand("copy");const i=t("#charitable-email-diagnostics-copy"),s=i.text();i.text("Copied!"),setTimeout(function(){i.text(s)},2e3)}}};return i}(document,window,jQuery);CharitableSystemInfo.init();