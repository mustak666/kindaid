var CharitableAdminReporting=window.CharitableAdminReporting||function(document,window,$){var s={},$reports,showGrowthToolsNotice=false,elements={},charts={};var app={settings:{clickWatch:false},init:function(){s=this.settings;$(app.ready)},ready:function(){if(typeof charitable_reporting==="undefined"){return}wpchar.debug("charitable_reporting");wpchar.debug(charitable_reporting);$reports=$("#charitable-reports");if($reports.length===0){return}elements.$start_datepicker=$("#charitable-reports-start_date");elements.$end_datepicker=$("#charitable-reports-end_date");elements.$filter_button=$("#charitable-reports-filter-button");elements.$report_campaign_filter=$("#report-campaign-filter");elements.$report_category_filter=$("#report-category-filter");elements.$top_donation_amount=$("#charitable-top-donation-total-amount");elements.$top_donation_count=$("#charitable-top-donation-total-count");elements.$top_donation_average=$("#charitable-top-donation-average");elements.$top_donation_donors_count=$("#charitable-top-donor-count");elements.$top_charitable_refund_total_amount=$("#charitable-top-refund-total-amount");elements.$top_charitable_refund_count=$("#charitable-top-refund-count");elements.$top_donors_list=$("#charitable-top-donors-list");elements.$donations_breakdown_list=$("#donations-breakdown-list");elements.$payment_methods_list=$("ul#charitable-payment-methods-list");elements.$activity_list=$("#charitable-activity-list");elements.$top_campaigns_list=$("#charitable-top-campaigns-list");elements.$report_date_range_filter=$("#report-date-range-filter");elements.$topnav_datepicker=$("#charitable-reports-topnav-datepicker");elements.$topnav_datepicker_comparefrom=$("#charitable-reports-topnav-datepicker-comparefrom-lybunt");elements.$topnav_datepicker_compareto=$("#charitable-reports-topnav-datepicker-compareto-lybunt");s.datePickerStartDate="";s.datePickerEndDate="";s.datePickerCompareFromStartDate="";s.datePickerCompareFromEndDate="";s.datePickerCompareToStartDate="";s.datePickerCompareToEndDate="";if(app.isAdvancedPage()){app.initDatePickerRanges("ranged")}else{app.initDatePickerRanges("")}app.initDatePicker();app.bindUIActions();app.initCharts();app.renderCharts();app.checkCategoryDropdown();app.updateDatePickerVars();app.initPagination()},updateDatePickerVars:function(){if($reports.find("input.charitable-datepicker-ranged").length===0){return}var drp=$reports.find("input.charitable-datepicker-ranged").data("daterangepicker");s.datePickerStartDate=drp.startDate._i?drp.startDate._i:"";s.datePickerEndDate=drp.endDate._i?drp.endDate._i:""},checkCategoryDropdown:function(){if(elements.$report_campaign_filter.val()==="-1"){elements.$report_category_filter.removeClass("charitable-disabled")}else{elements.$report_category_filter.val("-1").addClass("charitable-disabled")}},initDatePickerRanges:function(pickerType="ranged"){if(pickerType==="ranged"){if(typeof moment!=="undefined"){s.ranges={"This Year":[moment().startOf("year"),moment().endOf("year")],"Last Year":[moment().subtract(1,"year").startOf("year"),moment().subtract(1,"year").endOf("year")],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}}}else{if(typeof moment!=="undefined"){s.ranges={Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 14 Days":[moment().subtract(13,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}}}},initDatePicker:function(datepickerClass="ranged",datepickerObject=false){if(datepickerObject){var $the_datepicker=$reports.find(datepickerObject);$the_datepicker.daterangepicker({opens:"left",locale:{format:"Y/M/DD"},linkedCalendars:true,showCustomRangeLabel:true,alwaysShowCalendars:true,ranges:s.ranges},(function(start,end,label){wpchar.debug("first");wpchar.debug($the_datepicker);$the_datepicker.attr("data-start-date",start.format("Y/M/DD"));$the_datepicker.attr("data-end-date",end.format("Y/M/DD"));wpchar.debug($the_datepicker);s.datePickerStartDate=start.format("Y/M/DD");s.datePickerEndDate=end.format("Y/M/DD");wpchar.debug(app.getStartDateFromDatePicker());wpchar.debug(app.getEndDateFromDatePicker());wpchar.debug(elements.$topnav_datepicker);wpchar.debug("A new date selection was made: "+start.format("YYYY-MM-DD")+" to "+end.format("YYYY-MM-DD"))}))}else if(datepickerClass==="ranged"){$reports.find("input.charitable-datepicker-"+datepickerClass).daterangepicker({opens:"left",locale:{format:"Y/M/DD"},linkedCalendars:true,showCustomRangeLabel:true,alwaysShowCalendars:true,ranges:s.ranges},(function(start,end,label){elements.$topnav_datepicker.attr("data","start-date").val(start.format("Y/M/DD"));elements.$topnav_datepicker.attr("data","end-date").val(end.format("Y/M/DD"));s.datePickerStartDate=start.format("Y/M/DD");s.datePickerEndDate=end.format("Y/M/DD");wpchar.debug(app.getStartDateFromDatePicker());wpchar.debug(app.getEndDateFromDatePicker());wpchar.debug(elements.$topnav_datepicker);wpchar.debug("A new date selection was made: "+start.format("YYYY-MM-DD")+" to "+end.format("YYYY-MM-DD"))}));$reports.find("input#charitable-reports-topnav-datepicker-comparefrom-lybunt.charitable-datepicker-"+datepickerClass).daterangepicker({opens:"left",locale:{format:"Y/M/DD"},linkedCalendars:true,showCustomRangeLabel:true,alwaysShowCalendars:true,ranges:s.ranges},(function(start,end,label){wpchar.debug("second");wpchar.debug(start.format("Y/M/DD"));wpchar.debug(end.format("Y/M/DD"));elements.$topnav_datepicker_comparefrom.attr("data-start-date",start.format("Y/M/DD"));elements.$topnav_datepicker_comparefrom.attr("data-end-date",end.format("Y/M/DD"));s.datePickerCompareFromStartDate=start.format("Y/M/DD");s.datePickerCompareFromEndDate=end.format("Y/M/DD");wpchar.debug(app.getStartDateFromDatePicker());wpchar.debug(app.getEndDateFromDatePicker());wpchar.debug(elements.$topnav_datepicker_comparefrom);wpchar.debug(this);wpchar.debug(label);wpchar.debug("A new date selection was made: "+start.format("YYYY-MM-DD")+" to "+end.format("YYYY-MM-DD"))}));$reports.find("input#charitable-reports-topnav-datepicker-compareto-lybunt.charitable-datepicker-"+datepickerClass).daterangepicker({opens:"left",locale:{format:"Y/M/DD"},linkedCalendars:true,showCustomRangeLabel:true,alwaysShowCalendars:true,ranges:s.ranges},(function(start,end,label){wpchar.debug("second");wpchar.debug(start.format("Y/M/DD"));wpchar.debug(end.format("Y/M/DD"));elements.$topnav_datepicker_compareto.attr("data-start-date",start.format("Y/M/DD"));elements.$topnav_datepicker_compareto.attr("data-end-date",end.format("Y/M/DD"));s.datePickerCompareToStartDate=start.format("Y/M/DD");s.datePickerCompareToEndDate=end.format("Y/M/DD");wpchar.debug(app.getStartDateFromDatePicker());wpchar.debug(app.getEndDateFromDatePicker());wpchar.debug(elements.$topnav_datepicker_comparefrom);wpchar.debug(this);wpchar.debug(label);wpchar.debug("A new date selection was made: "+start.format("YYYY-MM-DD")+" to "+end.format("YYYY-MM-DD"))}))}else{wpchar.debug("using datepicker class: "+$("input."+datepickerClass).val());var $the_datepicker=$reports.find("input."+datepickerClass);$the_datepicker.daterangepicker({opens:"left",locale:{format:"Y/M/DD"},linkedCalendars:true,showCustomRangeLabel:true,alwaysShowCalendars:true,ranges:s.ranges},(function(start,end,label){wpchar.debug("third");wpchar.debug($the_datepicker);$the_datepicker.attr("data","start-date").val(start.format("Y/M/DD"));$the_datepicker.attr("data","end-date").val(end.format("Y/M/DD"));s.datePickerStartDate=start.format("Y/M/DD");s.datePickerEndDate=end.format("Y/M/DD");wpchar.debug(app.getStartDateFromDatePicker());wpchar.debug(app.getEndDateFromDatePicker());wpchar.debug(elements.$topnav_datepicker);wpchar.debug("A new date selection was made: "+start.format("YYYY-MM-DD")+" to "+end.format("YYYY-MM-DD"))}))}},bindUIActions:function(){$reports.on("click",".charitable-toggle",(function(e){e.preventDefault();$(this).blur();app.fieldSectionToggle($(this),"click")}));$reports.find(".charitable-report-download-items").each((function(){app.initDownloadButton($(this))}));$reports.on("click",'#charitable-reports-filter-button[data-filter-type="overview"]',(function(e){e.preventDefault();wpchar.debug("overview filter button clicked");var campaign_id=parseInt($("#report-campaign-filter").val())||-1;$reports.find('form#charitable-overview-print input[name="campaign_id"]').val(campaign_id);var category_id=parseInt($("#report-category-filter").val())||0;$reports.find('form#charitable-overview-print input[name="category_id"]').val(category_id);var start_date=app.getStartDateFromDatePicker();var end_date=app.getEndDateFromDatePicker();if(elements.$topnav_datepicker.length>0){elements.$topnav_datepicker.attr("data-start-date",start_date);elements.$topnav_datepicker.attr("data-end-date",end_date)}$reports.find('form#charitable-overview-print input[name="start_date"]').val(start_date);$reports.find('form#charitable-overview-print input[name="end_date"]').val(end_date);wpchar.debug("start_date: "+start_date);wpchar.debug("end_date: "+end_date);app.getOverviewReports()}));$reports.on("change","#report-advanced-type-filter",(function(e){e.preventDefault();app.loadAdvancedReportUI($(this).val())}));$reports.on("click",".charitable-advanced-filter-button a.button",(function(e){e.preventDefault();app.getAdvancedReports($(this))}));$reports.on("click",'#charitable-reports-filter-button[data-filter-type="activity"]',(function(e){e.preventDefault();app.getActivityReports()}));$reports.on("click",'#charitable-reports-filter-button[data-filter-type="donor"]',(function(e){e.preventDefault();app.getDonorReports()}));$reports.on("change","#report-campaign-filter",(function(e){app.checkCategoryDropdown()}));if(app.isDashboardPage()){$reports.on("change","#report-date-range-filter",(function(e){e.preventDefault();$reports.find('form#charitable-dashboard-print input[name="days"]').val($(this).val());app.getDashboardReports()}))}},fieldSectionToggle:function(el,action){var $this=$(el),$nearestContainer=$this.closest(".charitable-container"),$toggleGroup=$nearestContainer.find(".charitable-toggle-container"),sectionName=$nearestContainer.data("section-name"),$icon=$this.find("i"),cookieName="charitable_reports_section_"+sectionName;if(action==="click"){$icon.toggleClass("charitable-angle-right");$toggleGroup.stop().slideToggle("",(function(){$nearestContainer.toggleClass("charitable-closed");if($nearestContainer.hasClass("charitable-closed")){$nearestContainer.removeClass("charitable-open");wpCookies.remove(cookieName)}else{wpCookies.set(cookieName,"true",2592e3)}}));return}},loadAdvancedReportUI:function(slug=""){wpchar.debug(charitable_reporting);wpchar.debug(charitable_reporting.advanced_reports[slug].title);wpchar.debug(slug);$reports.find(".charitable-advanced-date-picker, .charitable-advanced-filter-button").addClass("charitable-hidden");$reports.find('.charitable-advanced-date-picker[data-report-type="'+slug+'"]').removeClass("charitable-hidden");$reports.find('.charitable-advanced-filter-button[data-report-type="'+slug+'"]').removeClass("charitable-hidden");app.disableUI();app.reportUILoadingOn();var data={action:"charitable_report_advanced_ui",nonce:charitable_reporting.nonce,report_type:slug,report_title:charitable_reporting.advanced_reports[slug].title,report_description:charitable_reporting.advanced_reports[slug].description,start_date:s.datePickerStartDate,end_date:s.datePickerEndDate};$.post(charitable_reporting.ajax_url,data,(function(response){if(response.success){wpchar.debug("response success");if(typeof charitable_reporting.advanced_reports[slug]!=="undefined"){$reports.find(".charitable-title-card-content h2").html(charitable_reporting.advanced_reports[slug].title);$reports.find(".charitable-title-card-content div.charitable-report-description").html(charitable_reporting.advanced_reports[slug].description)}if(response.data.html){$reports.find("#charitable-report-advanced-container").html(response.data.html)}else{$reports.find("#charitable-report-advanced-container").html("")}app.enableUI();app.reportUILoadingOff()}}));app.initDatePicker(false,'.charitable-advanced-date-picker[data-report-type="'+slug+'"] input.charitable-reports-datepicker');if(slug!=="lybunt"){s.datePickerStartDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+slug+'"]').find("input.charitable-reports-datepicker").data("start-date");s.datePickerEndDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+slug+'"]').find("input.charitable-reports-datepicker").data("end-date")}else{s.datePickerCompareFromStartDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+slug+'"]').find("input#charitable-reports-topnav-datepicker-comparefrom-lybunt").data("start-date");s.datePickerCompareFromEndDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+slug+'"]').find("input#charitable-reports-topnav-datepicker-comparefrom-lybunt").data("end-date");s.datePickerCompareToStartDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+slug+'"]').find("input#charitable-reports-topnav-datepicker-compareto-lybunt").data("start-date");s.datePickerCompareToEndDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+slug+'"]').find("input#charitable-reports-topnav-datepicker-compareto-lybunt").data("end-date")}},getDashboardReports:function(){var data={action:"charitable_report_dashboard_data",nonce:charitable_reporting.nonce,start_date:app.getDashboardStartDate(),end_date:app.getDashboardEndDate(),days:app.getDashboardDays()};app.disableUI();app.reportUILoadingOn();$.post(charitable_reporting.ajax_url,data,(function(response){if(response.success){wpchar.debug("dashboard response success");showGrowthToolsNotice=false;if(response.data.html.charitable_cards){wpchar.debug("updating dashboard with: "+response.data.html.charitable_cards);$reports.find("#charitable-dashboard-report-cards").html(response.data.html.charitable_cards)}if(response.data.html.charitable_reports){wpchar.debug("updating dashboard with: "+response.data.html.charitable_reports);$reports.find("#charitable-dashboard-report-sections").html(response.data.html.charitable_reports)}if($reports.find("form#charitable-dashboard-print").length>0){$reports.find('form#charitable-dashboard-print input[name="start_date"]').val(response.data.start_date);$reports.find('form#charitable-dashboard-print input[name="end_date"]').val(response.data.end_date);$reports.find('form#charitable-dashboard-print input[name="days"]').val(response.data.days)}wpchar.debug(charts.headlineChart);wpchar.debug(response.data.headline_chart_options.donation_axis);wpchar.debug(response.data.headline_chart_options.date_axis);if(charts.headlineChart&&response.data.headline_chart_options.donation_axis&&response.data.headline_chart_options.date_axis){charts.headlineChart.updateOptions({series:[{name:"Donations",data:response.data.headline_chart_options.donation_axis}],xaxis:{categories:response.data.headline_chart_options.date_axis}});var isAllZero=response.data.headline_chart_options.donation_axis.every((function(val){return val===0}));if(response.data.headline_chart_options.donation_axis.length===0||isAllZero===false){showGrowthToolsNotice=false}else{showGrowthToolsNotice=true}if(showGrowthToolsNotice&&$(".charitable-growth-tools-notice").length){$(".charitable-growth-tools-notice").removeClass("charitable-hidden")}else{$(".charitable-growth-tools-notice").addClass("charitable-hidden")}}app.enableUI();app.reportUILoadingOff()}}))},getOverviewReports:function(){var data={action:"charitable_report_overview_data",nonce:charitable_reporting.nonce,start_date:app.getStartDateFromDatePicker(),end_date:app.getEndDateFromDatePicker(),campaign_id:parseInt($("#report-campaign-filter").val())||0,campaign_category_id:parseInt($("#report-category-filter").val())||0,filter:$("#report-date-range-filter").val()};app.disableUI();app.reportUILoadingOn();$.post(charitable_reporting.ajax_url,data,(function(response){if(response.success){wpchar.debug("response success");if(response.data.html.donation_breakdown){elements.$donations_breakdown_list.html(response.data.html.donation_breakdown)}if(charts.headlineChart&&response.data.headline_chart_options.donation_axis&&response.data.headline_chart_options.date_axis){charts.headlineChart.updateOptions({series:[{name:"Donations",data:response.data.headline_chart_options.donation_axis}],xaxis:{categories:response.data.headline_chart_options.date_axis}})}if(response.data.donation_amount){elements.$top_donation_amount.html(response.data.donation_amount)}if(response.data.donation_count){elements.$top_donation_count.html(response.data.donation_count)}else{elements.$top_donation_count.html("0")}if(response.data.donation_average){elements.$top_donation_average.html(response.data.donation_average)}else{elements.$top_donation_average.html("0")}if(response.data.donors_count){elements.$top_donation_donors_count.html(response.data.donors_count)}else{elements.$top_donation_donors_count.html("0")}if(response.data.refund_total_amount){elements.$top_charitable_refund_total_amount.html(response.data.refund_total_amount)}if(response.data.refund_count){elements.$top_charitable_refund_count.html(response.data.refund_count)}else{elements.$top_charitable_refund_count.html("0")}if(response.data.html.payment_methods_list){elements.$payment_methods_list.html(response.data.html.payment_methods_list)}if(charts.paymentMethodsChart&&response.data.payment_methods_chart.payment_percentages&&response.data.payment_methods_chart.payment_labels){charts.paymentMethodsChart.updateOptions({series:response.data.payment_methods_chart.payment_percentages,labels:response.data.payment_methods_chart.payment_labels})}if(response.data.html.activities){wpchar.debug("updating activities with: "+response.data.html.activities);$reports.find(".charitable-activity-report .charitable-report-ui .the-list").html(response.data.html.activities)}if(response.data.html.top_donors_list){wpchar.debug("updating top donors with: "+response.data.html.top_donors_list);$reports.find(".charitable-top-donors-report .charitable-report-ui").html(response.data.html.top_donors_list)}if(response.data.html.top_campaigns_list){elements.$top_campaigns_list.html(response.data.html.top_campaigns_list)}$reports.find('#charitable-donations-breakdown-download-form input[name="start_date"]').val(app.getStartDateFromDatePicker());$reports.find('#charitable-donations-breakdown-download-form input[name="end_date"]').val(app.getEndDateFromDatePicker());$reports.find('#charitable-donations-breakdown-download-form input[name="campaign_id"]').val(parseInt($("#report-campaign-filter").val()));$reports.find('#charitable-donations-breakdown-download-form input[name="category_id"]').val(parseInt($("#report-category-filter").val()));app.enableUI();app.reportUILoadingOff();app.checkCategoryDropdown()}}))},getAdvancedReports:function($button=false){var report_type=$button.parent().data("report-type"),data={};if("lybunt"===report_type){var datePickerCompareFromStartDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+report_type+'"]').find("input#charitable-reports-topnav-datepicker-comparefrom-lybunt").attr("data-start-date"),datePickerCompareFromEndDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+report_type+'"]').find("input#charitable-reports-topnav-datepicker-comparefrom-lybunt").attr("data-end-date"),datePickerCompareToStartDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+report_type+'"]').find("input#charitable-reports-topnav-datepicker-compareto-lybunt").attr("data-start-date"),datePickerCompareToEndDate=$reports.find('.charitable-advanced-date-picker[data-report-type="'+report_type+'"]').find("input#charitable-reports-topnav-datepicker-compareto-lybunt").attr("data-end-date");data={action:"charitable_report_advanced_data",nonce:charitable_reporting.nonce,report_type:report_type,compare_from_start_date:datePickerCompareFromStartDate,compare_from_end_date:datePickerCompareFromEndDate,compare_to_start_date:datePickerCompareToStartDate,compare_to_end_date:datePickerCompareToEndDate}}else{var start_date=s.datePickerStartDate,end_date=s.datePickerEndDate;data={action:"charitable_report_advanced_data",nonce:charitable_reporting.nonce,report_type:report_type,start_date:start_date,end_date:end_date}}app.disableUI();app.reportUILoadingOn();$.post(charitable_reporting.ajax_url,data,(function(response){if(response.success){wpchar.debug("response success");if(typeof charitable_reporting.advanced_reports[report_type]!=="undefined"){$reports.find(".charitable-title-card-content h2").html(charitable_reporting.advanced_reports[report_type].title);$reports.find(".charitable-title-card-content div.charitable-report-description").html(charitable_reporting.advanced_reports[report_type].description)}if(response.data.html){$reports.find("#charitable-report-advanced-container").html(response.data.html)}app.enableUI();app.reportUILoadingOff()}}))},getActivityReports:function(){var data={action:"charitable_report_activity_data",nonce:charitable_reporting.nonce,start_date:app.getStartDateFromDatePicker(),end_date:app.getEndDateFromDatePicker(),campaign_id:parseInt($("#report-campaign-filter").val()),activity_type:$("#report-activity-type-filter").val()};app.disableUI();app.reportUILoadingOn();$.post(charitable_reporting.ajax_url,data,(function(response){if(response.success){wpchar.debug("response success");if(response.data.html.activities){wpchar.debug("updating activities with: "+response.data.html.activities);$reports.find(".charitable-the-list-container").html(response.data.html.activities)}$reports.find('#charitable-activity-download-form input[name="start_date"]').val(app.getStartDateFromDatePicker());$reports.find('#charitable-activity-download-form input[name="end_date"]').val(app.getEndDateFromDatePicker());$reports.find('#charitable-activity-download-form input[name="campaign_id"]').val(parseInt($("#report-campaign-filter").val()));$reports.find('#charitable-activity-download-form input[name="activity_type"]').val($("#report-activity-type-filter").val());app.enableUI();app.reportUILoadingOff()}}))},getDonorReports:function(){var data={action:"charitable_report_donor_data",nonce:charitable_reporting.nonce,report_type:$("#report-donor-type-filter").val(),limit:$("#report-donor-limit").val(),offset:$("#report-donor-offset").val(),ppage:$("#report-donor-ppage").val()};app.disableUI();app.reportUILoadingOn();$.post(charitable_reporting.ajax_url,data,(function(response){if(response.success){if(response.data.html.donors){wpchar.debug("updating donors with: "+response.data.html.donors);$reports.find("#charitable-report-donor-container").html(response.data.html.donors)}if(response.data.html.title_card){$reports.find("#charitable-report-donor-title-card").html(response.data.html.title_card)}app.enableUI();app.reportUILoadingOff()}}))},initPagination:function(){if($reports.find(".charitable-reports-pagination-nav").length===0){return}$reports.on("click",".charitable-reports-pagination-nav .page-item a.page-link",(function(e){e.preventDefault();var $this=$(this),limit=$this.data("limit"),offset=$this.data("offset"),ppage=$this.data("ppage"),total_pages=$this.data("total-pages"),current_page=$this.data("current-page"),report_type=$this.data("report-type"),page=$this.data("page"),tab=$this.data("tab");var data={action:"charitable_report_donor_data_pagination",nonce:charitable_reporting.nonce,limit:limit,offset:offset,ppage:ppage,total_pages:total_pages,current_page:current_page,report_type:report_type,page:page,tab:tab};$.post(charitable_reporting.ajax_url,data,(function(response){if(response.success){if(response.data.html.donors){$reports.find("#charitable-report-donor-container").html(response.data.html.donors)}}}))}))},initHeadlineChart:function(){if($("#charitable-headline-graph").length===0){this.return}var enableToolTips=false;if(typeof charitable_reporting.headline_chart_options.enable_tooltips!=="undefined"&&false!==charitable_reporting.headline_chart_options.enable_tooltips){enableToolTips=true}var headlineChartOptions={chart:{type:"area",width:"100%",height:400,foreColor:"#757781",toolbar:{autoSelected:"pan",show:false},events:{animationEnd:function(chartContext,options){if(showGrowthToolsNotice&&$(".charitable-growth-tools-notice").length){$(".charitable-growth-tools-notice").removeClass("charitable-hidden")}}}},series:[{name:"Donations",data:charitable_reporting.headline_chart_options.donation_axis}],colors:["#5AA15226"],grid:{borderColor:"#C9D4CA",clipMarkers:false,yaxis:{lines:{show:true}}},stroke:{width:3,colors:["#5AA152"]},fill:{type:"solid"},tooltip:{enabled:enableToolTips,theme:"dark"},dataLabels:{enabled:false},markers:{size:5,colors:["#FFFFFF"],strokeColor:"#5AA152",strokeWidth:4},xaxis:{categories:charitable_reporting.headline_chart_options.date_axis},yaxis:{labels:{formatter:value=>{var decimalCount=typeof charitable_reporting.decimal_count!=="undefined"?charitable_reporting.decimal_count:2;return charitable_reporting.currency_symbol+value.toFixed(decimalCount)}},min:0}};charts.headlineChart=new ApexCharts(document.querySelector("#charitable-headline-graph"),headlineChartOptions);if(typeof charitable_reporting.headline_chart_options.donation_axis!=="undefined"){if(charitable_reporting.headline_chart_options.donation_axis.every((function(i){return i===0}))){showGrowthToolsNotice=true}else{showGrowthToolsNotice=false}}},initPaymentChart:function(){if(!app.isDashboardPage()){this.return}if($("#charitable-payment-methods-graph").length===0){this.return}if(typeof charitable_reporting.payment_methods_chart_options==="undefined"){this.return}var paymentMethodColors={stripe:"#5AA152",offline:"#9e36f9",manual:"#F99E36",paypal:"#2B66D1",square_core:"#d21561",square:"#d21561"};var defaultColors=["#d21561","#9e36f9","#F99E36","#2B66D1","#5AA152"];var paymentKeys=typeof charitable_reporting.payment_methods_chart_options.payment_keys!=="undefined"?charitable_reporting.payment_methods_chart_options.payment_keys:[];var colors=[];var colorIndex=0;for(var i=0;i<paymentKeys.length;i++){var key=paymentKeys[i];if(key&&paymentMethodColors[key]){colors.push(paymentMethodColors[key])}else if(key){colors.push(defaultColors[colorIndex%defaultColors.length]);colorIndex++}else{colors.push(defaultColors[0])}}if(colors.length===0){colors=defaultColors}var paymentMethodsChartOptions={series:charitable_reporting.payment_methods_chart_options.payment_percentages,labels:charitable_reporting.payment_methods_chart_options.payment_labels,colors:colors,chart:{type:"donut",width:"75%",toolbar:{autoSelected:"pan",show:false}},dataLabels:{enabled:false},yaxis:{labels:{formatter:value=>value+"%"}},plotOptions:{pie:{donut:{size:"80%"}}},total:{show:true,showAlways:true,label:"Total",fontSize:"22px",fontFamily:"Helvetica, Arial, sans-serif",fontWeight:600,color:"#373d3f",formatter:function(w){return w.globals.seriesTotals.reduce(((a,b)=>a+b),0)}},legend:{show:false,showForSingleSeries:true,showForNullSeries:true,showForZeroSeries:true,position:"bottom",horizontalAlign:"center",floating:false,fontSize:"14px",fontFamily:"Helvetica, Arial",fontWeight:400,inverseOrder:true,customLegendItems:[],offsetX:0,offsetY:0,labels:{useSeriesColors:false},markers:{width:12,height:12,strokeWidth:0,strokeColor:"#fff",radius:12,offsetX:0,offsetY:0,customHTML:function(){return'<span class="custom-marker">test</span>'}},itemMargin:{horizontal:5,vertical:0}}};charts.paymentMethodsChart=new ApexCharts(document.querySelector("#charitable-payment-methods-graph"),paymentMethodsChartOptions)},initCharts:function(){app.initHeadlineChart();app.initPaymentChart()},renderHeadlineChart:function(){if($("#charitable-headline-graph").length===0){return}charts.headlineChart.render()},renderPaymentChart:function(){if($("#charitable-payment-methods-graph").length===0){return}charts.paymentMethodsChart.render()},renderCharts:function(){app.renderHeadlineChart();app.renderPaymentChart()},disableUI:function(){$reports.find("a, button, input, select").attr("disabled","disabled").addClass("charitable-disabled")},enableUI:function(){$reports.find("a, button, input, select").removeAttr("disabled").removeClass("charitable-disabled")},reportUILoadingOn:function(){$reports.find(".charitable-report-ui, .charitable-activity-list-container").addClass("charitable-section-loading")},reportUILoadingOff:function(){$reports.find(".charitable-report-ui, .charitable-activity-list-container").removeClass("charitable-section-loading")},getStartDateFromDatePicker:function(){return s.datePickerStartDate},getEndDateFromDatePicker:function(){return s.datePickerEndDate},getStartDateFromCompareFromDatePicker:function(){return s.datePickerCompareFromStartDate},getEndDateFromCompareFromDatePicker:function(){return s.datePickerCompareFromEndDate},getStartDateFromCompareToDatePicker:function(){return s.datePickerCompareToStartDate},getEndDateFromCompareToDatePicker:function(){return s.datePickerCompareToEndDate},getDashboardStartDate:function(){return $reports.find("#charitable-dashboard-report-start-date").val()},getDashboardEndDate:function(){return $reports.find("#charitable-dashboard-report-end-date").val()},getDashboardDays:function(){return $reports.find("#report-date-range-filter").val()},isAdvancedPage:function(){return $(".charitable-advanced-report").length>0},isDashboardPage:function(){return $("#charitable-dashboard-report-container").length>0},decodeHtml:function(html){var txt=document.createElement("textarea");txt.innerHTML=html;return txt.value}};return app}(document,window,jQuery);CharitableAdminReporting.init();