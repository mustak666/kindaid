var CharitableCampaignBuilder=window.CharitableCampaignBuilder||function(e,a,t){var i,l,n,r={},o=!0,d=!1,c={settings:{spinner:'<i class="charitable-loading-spinner"></i>',spinnerInline:'<i class="charitable-loading-spinner charitable-loading-inline"></i>',tinymceDefaults:{tinymce:{toolbar1:"bold,italic,underline,blockquote,strikethrough,bullist,numlist,alignleft,aligncenter,alignright,undo,redo,link"},quicktags:!0},pagebreakTop:!1,pagebreakBottom:!1,upload_img_modal:!1},init:function(){var e=this;charitable_panel_switch=!0,i=this.settings,t(c.ready),t(a).on("load",function(){"function"==typeof t.ready.then?t.ready.then(c.load):c.load()}),t(a).on("beforeunload",function(){if(!e.formIsSaved()&&o)return charitable_builder.are_you_sure_to_close})},load:function(){wpchar.getQueryString("newcampaign")&&c.formSave(!1);if(CharitableUtils.triggerEvent(l,"CharitableCampaignBuilderReady").isDefaultPrevented())return!1;c.hideLoadingOverlay(),c.initCodeEditor()},ready:function(){if(c.isVisitedViaBackButton())location.reload();else{if(c.showLoadingOverlay(),i.version="1.8.4.3",l=t("#charitable-builder"),n=t("#charitable-builder-form"),r.$helpButton=t("#charitable-help"),r.$previewButton=t("#charitable-preview-btn"),r.$viewCampaignButton=t("#charitable-view-btn"),r.$embedButton=t("#charitable-embed"),r.$statusButton=t("#charitable-status-button"),r.$saveButton=t("#charitable-save"),r.$exitButton=t("#charitable-exit"),r.$templateButton=t(".charitable-panel-template-button"),r.$designButton=t(".charitable-panel-design-button"),r.$settingsButton=t(".charitable-panel-settings-button"),r.$marketingButton=t(".charitable-panel-marketing-button"),r.$paymentButton=t(".charitable-panel-payment-button"),r.$noFieldsOptions=t(".charitable-panel-fields .charitable-no-fields-holder .no-fields"),r.$noFieldsPreview=t(".charitable-panel-fields .charitable-no-fields-holder .no-fields-preview"),r.$formPreview=t(".charitable-panel-fields .charitable-preview-wrap"),r.$revisionPreview=t("#charitable-panel-revisions .charitable-panel-content"),r.$focusOutTarget=null,r.$preview=t(".charitable-preview"),r.$panelDesign=t("#charitable-panel-design"),r.$nextFieldId=t("#charitable-field-id"),r.$fieldOptions=t("#charitable-field-options"),r.$fieldsPreviewWrap=t(".charitable-panel-fields .charitable-panel-content-wrap"),r.$sortableFieldsWrap=t(".charitable-panel-fields .charitable-field-wrap"),r.$sortableTabsWrap=t(".charitable-panel-fields .charitable-tab-wrap"),r.$sortableTabNav=t(".charitable-campaign-preview nav.charitable-campaign-preview-nav"),r.$sortableTabContent=t(".charitable-campaign-preview .tab-content"),r.$addFieldsButtons=t(".charitable-add-fields-button").not(".not-draggable").not(".warning-modal").not(".charitable-not-available").not(".charitable-not-installed").not(".charitable-not-activated").not(".charitable-installed-refresh").not(".charitable-addon-file-missing").not(".charitable-need-upgrade"),r.$templatePanel=t("#charitable-panel-template"),r.$templatePreview=t(".charitable-template-preview"),r.$settingsPanel=t("#charitable-panel-settings"),r.$campaignID=t('#charitable-builder-form input[name="id"]'),r.$templateID=t('#charitable-builder-form input[name="template_id"]'),r.$templateLabel=t('#charitable-builder-form input[name="template_label"]'),r.$postStatus=t('#charitable-builder-form input[name="post_status"]'),r.$primaryThemeColorBase=t('#charitable-builder-form input[name="color_base_primary"]'),r.$secondaryThemeColorBase=t('#charitable-builder-form input[name="color_base_secondary"]'),r.$tertiaryThemeColorBase=t('#charitable-builder-form input[name="color_base_tertiary"]'),r.$buttonThemeColorBase=t('#charitable-builder-form input[name="color_base_button"]'),c.bindUIActions(),i.formID=n.data("id"),i.templateID=n.data("template-id"),i.templateLabel=n.data("template-label"),i.primaryThemeColorBase=i.primaryThemeColor=t(this).closest(".charitable-template").data("template-primary"),i.secondaryThemeColorBase=i.secondaryThemeColor=t(this).closest(".charitable-template").data("template-secondary"),i.tertiaryThemeColorBase=i.tertiaryThemeColor=t(this).closest(".charitable-template").data("template-tertiary"),i.buttonThemeColorBase=i.buttonThemeColor=t(this).closest(".charitable-template").data("template-button"),i.primaryThemeColorBase=r.$primaryThemeColorBase.val().length>0?r.$primaryThemeColorBase.val():"",i.secondaryThemeColorBase=r.$secondaryThemeColorBase.val().length>0?r.$secondaryThemeColorBase.val():"",i.tertiaryThemeColorBase=r.$tertiaryThemeColorBase.val().length>0?r.$tertiaryThemeColorBase.val():"",i.buttonThemeColorBase=r.$buttonThemeColorBase.val().length>0?r.$buttonThemeColorBase.val():"",i.primaryThemeColor="",i.secondaryThemeColor="",i.tertiaryThemeColor="",i.buttonThemeColor="",i.formSaved=n.find("#charitable-form-saved").val(),i.formSavedStatus=n.find("#charitable-form-post-status").val(),i.formSavedStatusLabel=n.find("#charitable-form-post-status-label").val(),i.formStatus=i.formSavedStatus.length>0?i.formSavedStatus:"draft",i.formStatusLabel=i.formSavedStatusLabel.length>0?i.formSavedStatusLabel:"Draft",i.campaignTitle=t("input#charitable_settings_title").val(),i.campaignDescription=t('div[data-special-type="campaign_description"] .campaign-builder-htmleditor').first().html(),i.campaignOverview=t('div[data-special-type="campaign_overview"] .campaign-builder-htmleditor').length>0?t('div[data-special-type="campaign_overview"] .campaign-builder-htmleditor').first().html():"",i.maxNumberOfTabs=4,i.denyList={"donation-form":{"donate-button":0,"donation-form":0,"donate-amount":0},"donate-button":{"donation-form":0},"donate-amount":{"donation-form":0}},i.pagebreakTop=t(".charitable-pagebreak-top").length,i.pagebreakBottom=t(".charitable-pagebreak-bottom").length,i.didInitHTMLEditorFields=!1,i.quilled=[],i.currentModal=!1,l.on("keypress","#charitable-builder-form :input:not(textarea)",function(e){13===e.keyCode&&e.preventDefault()}),t(".charitable-panel").each(function(e,a){var i=t(this),l=i.find(".charitable-panel-sidebar-section.configured").first();if(l.length){var n=l.data("section");l.addClass("active"),i.find(".charitable-panel-content-section-"+n).show().addClass("active"),i.find(".charitable-panel-content-section-default").hide()}else i.find(".charitable-panel-content-section").hide().removeClass("active"),i.find(".charitable-panel-content-section").first().show().addClass("active"),i.find(".charitable-panel-sidebar-section:first-of-type").addClass("active")}),c.builderHotkeys(),"undefined"!=typeof jconfirm&&(jconfirm.defaults={closeIcon:!1,backgroundDismiss:!1,escapeKey:!0,animationBounce:1,useBootstrap:!1,theme:"modern",boxWidth:"400px",animateFromElement:!1,draggable:!1,content:charitable_builder.something_went_wrong}),t(".campaign-builder-datepicker").each(function(){c.initDatePicker(t(this))}),t(".campaign-tag-field").each(function(){c.initTagField(t(this))}),t(".charitable-campaign-suggested-donations").each(function(){c.initSuggestedDonations(t(this))}),t(".charitable-campaign-suggested-donations-mini").each(function(){c.initSuggestedDonationsMini(t(this)),c.updateSuggestdDonationsMiniRowsFromSettings(t(this))}),c.initColorPicker(),c.initTemplatePanel(),c.initStatusButton(),c.updateGoalRelatedItems(),c.updateEndDateRelatedItems(),c.resizeTopCampaignTitleInputBox(),!1!==c.hasTemplate()){var e=null!==wpCookies.get("charitable_panel")&&wpCookies.get("charitable_panel").trim();void 0!==e&&e.length>0&&"template"!==e?c.panelSwitch(e):c.panelSwitch("design"),c.checkFieldAllow(),c.redirectBasedOnCookies(e)}else c.forceTemplateSelect(),c.setCampaignTitleNotSet();c.openModalButtonClick(),c.confirmCampaignDeletion(),t(".education-buttons button").click(function(){a.open("https://www.wpcharitable.com/pricing/")}),t(".campaign-builder-campaign-creator-id select").select2({templateResult:c.campaignCreatorFormatOptions}),t(".campaign-builder-campaign-creator-id-mini select").select2({templateResult:c.campaignCreatorFormatOptions})}},campaignCreatorFormatOptions:e=>e.id?t('<span class="charitable-select2-avatar"><img width="20px" height="20px" style="display: inline-block; float: left; margin-right: 10px;" src="'+e.element.dataset.avatar+'" /> '+e.text+'</span><span class="charitable-select2-meta"> '+e.element.dataset.meta+"</span>"):e.text,redirectBasedOnCookies(e=!1){var a=wpCookies.get("charitable_panel_content_section"),i=""!==wpCookies.get("charitable_panel_active_field_id")?parseInt(wpCookies.get("charitable_panel_active_field_id")):"",l=wpCookies.get("charitable_panel_tab_section_tab_id"),n=wpCookies.get("charitable_panel_design_layout_options_group");t(".charitable-preview").is(":visible")&&t("ul.charitable-tabs li#layout-options").is(":visible")&&""!==n&&""===i?(t("ul.charitable-tabs li#layout-options a").hasClass("active")||t("ul.charitable-tabs li#layout-options a").click(),t("#charitable-field-options div.charitable-layout-options-tab-"+n+" a.charitable-group-toggle").click()):t(".charitable-preview").is(":visible")&&""!==l&&t('nav.charitable-campaign-preview-nav li[data-tab-id="'+l+'"] a').is(":visible")?t('.charitable-preview nav.charitable-campaign-preview-nav li[data-tab-id="'+l+'"] a').click():t(".charitable-preview").is(":visible")&&t("#charitable-field-"+i+" a").is(":visible")?c.clickFieldEdit(i):t(".charitable-panel-sidebar").is(":visible")&&t('a.charitable-panel-sidebar-section[data-section="'+a+'"').is(":visible")?t('a.charitable-panel-sidebar-section[data-section="'+a+'"').click():""!==i&&t("#charitable-field-"+i).is(":visible")?t("#charitable-field-"+i).click():t(".charitable-panel-sidebar").is(":visible")&&a&&t(".charitable-tabs").is(":visible")&&t(".charitable-tabs li#"+a+" a").is(":visible")?t(".charitable-tabs li#"+a+" a").click():!1===e&&!1!==c.hasTemplate()?c.panelSwitch("design"):wpchar.debug("redirectBasedOnCookies nothing")},clickFieldEdit(e){t("#charitable-field-"+e+" a.charitable-field-edit").click()},refreshTabFieldsSortDrag(){r.$sortableTabContent=t(".charitable-campaign-preview .tab-content")},hasTemplate:()=>void 0!==i.templateID&&i.templateID.length>0||parseInt(r.$templateID.val())>0,forceTemplateSelect(){t("#charitable-panels-toggle").find("button").removeClass("active").addClass("disabled"),r.$templateButton.removeClass("disabled").addClass("active"),c.panelSwitch("template")},unforceTemplateSelect(){t("#charitable-panels-toggle").find("button").removeClass("disabled")},disableTemplateSelect(){r.$templateButton.removeClass("active").addClass("disabled")},updateTemplateID(e="",a=""){r.$templateID.val(e),r.$templateLabel.val(a),c.updateThemeCSS(null,e,i.primaryThemeColor,i.secondaryThemeColor,i.tertiaryThemeColor,i.buttonThemeColor,!1),t(".charitable-preview").removeClass(function(e,a){return(a.match(/(^|\s)charitable-builder-template-\S+/g)||[]).join(" ")}).addClass("charitable-builder-template-"+e),""!==a?t(".charitable-preview-top-bar .charitable-campaign-theme-label").text(a):""!==e&&t(".charitable-preview-top-bar .charitable-campaign-theme-label").text(e)},updateThemeCSS(e=null,a="",l="",n="",r="",o="",d=!0){if(""!==a||""!==i.templateID){void 0!==i.primaryThemeColor&&""!==l||(l=void 0!==i.primaryThemeColor&&""!==i.primaryThemeColor?i.primaryThemeColor:void 0!==i.primaryThemeColorBase&&""!==i.primaryThemeColorBase?i.primaryThemeColorBase:"000000"),void 0!==i.secondaryThemeColor&&""!==n||(n=void 0!==i.secondaryThemeColor&&""!==i.secondaryThemeColor?i.secondaryThemeColor:void 0!==i.secondaryThemeColorBase&&""!==i.secondaryThemeColorBase?i.secondaryThemeColorBase:"000000"),void 0!==i.tertiaryThemeColor&&""!==r||(r=void 0!==i.tertiaryThemeColor&&""!==i.tertiaryThemeColor?i.tertiaryThemeColor:void 0!==i.tertiaryThemeColorBase&&""!==i.tertiaryThemeColorBase?i.tertiaryThemeColorBase:"000000"),void 0!==i.buttonThemeColor&&""!==o||(o=void 0!==i.buttonThemeColor&&""!==i.buttonThemeColor?i.buttonThemeColor:void 0!==i.buttonThemeColorBase&&""!==i.buttonThemeColorBase?i.buttonThemeColorBase:"000000");var s="p="+(l=l.replace(/[^a-zA-Z 0-9]+/g,""))+"&s="+(n=n.replace(/[^a-zA-Z 0-9]+/g,""))+"&t="+(r=r.replace(/[^a-zA-Z 0-9]+/g,""))+"&b="+(o=o.replace(/[^a-zA-Z 0-9]+/g,""))+"&ver="+i.version;!1===d&&t('link[id="charitable-builder-template-preview-theme-css"]').attr("href",charitable_builder.charitable_rest_url+"campaign-css-admin/"+a+"?"+s),null!==e?c.replaceCSSFile(e,a,s):(c.replaceCSSFile("primary",a,s),c.replaceCSSFile("secondary",a,s),c.replaceCSSFile("tertiary",a,s),c.replaceCSSFile("button",a,s))}},replaceCSSFile:function(e,a,i){t("head").find("link#charitable-builder-template-preview-theme-colors-"+e+"-css").remove(),t("head").append('<link rel="stylesheet" data-color-type="'+e+'" id="charitable-builder-template-preview-theme-colors-temp" href="'+charitable_builder.charitable_rest_url+"campaign-css-admin/"+a+"-colors?"+i+'" type="text/css" media="screen">'),t("#charitable-design-wrap").addClass("loading"),setTimeout(function(){t("head").find("#charitable-builder-template-preview-theme-colors-temp").attr("id","charitable-builder-template-preview-theme-colors-"+e+"-css"),t("#charitable-design-wrap").removeClass("loading")},250)},searchTemplate:function(e){e.preventDefault();let a=t(".charitable-setup-templates-categories li.active").data("category"),i=t(this).val();c.performSearch(i,a)},performSearch(e="",a=""){let i=r.$templatePreview.find(".charitable-template-list");""!==e||""!==a&&"all"!==a?(i.find(".charitable-template-list-container-item").addClass("charitable-hidden"),""!==e&&""!==a&&"all"!==a?i.find('.charitable-template[data-template-tags*="'+e+'"][data-template-categories*="'+a+'"]').parent().removeClass("charitable-hidden"):""===e||""!==a&&"all"!==a?i.find('.charitable-template[data-template-tags*="'+a+'"],.charitable-template[data-template-categories*="'+a+'"]').parent().removeClass("charitable-hidden"):i.find('.charitable-template[data-template-tags*="'+e+'"],.charitable-template[data-template-categories*="'+e+'"]').parent().removeClass("charitable-hidden")):i.find(".charitable-template-list-container-item").removeClass("charitable-hidden");var l=t(".charitable-template-list-container-item").not(".hidden").length;t(".charitable-templates-no-results").toggle(!l),r.$templatePreview.find("#charitable-setup-template-search").val()?r.$templatePreview.find(".charitable-setup-templates-search-wrap .fa-close").show():r.$templatePreview.find(".charitable-setup-templates-search-wrap .fa-close").hide(),c.showCheckTemplateList(),c.showUpgradeBanner()},selectCategory:function(e){e.preventDefault();let a=t(this),i=a.closest("ul").find(".active"),l=a.data("category"),n=t("#charitable-setup-template-search").val();i.removeClass("active"),a.addClass("active"),c.performSearch(n,l)},showUpgradeBanner:function(){if(!t("#tmpl-charitable-templates-upgrade-banner").length)return;if(t("#charitable-template-list .charitable-template-upgrade-banner").length>0&&t("#charitable-template-list .charitable-template-upgrade-banner").remove(),!c.isFunction(wp.template))return void wpchar.debug("wp.template not a function");wpchar.debug("wp.template is a function");let e=wp.template("charitable-templates-upgrade-banner");if(!e)return;const a=t("#charitable-template-list .charitable-template-list-container-item:not(.charitable-hidden)"),i=t("#charitable-template-list .charitable-template-list-container-item");a.length>5?t("#charitable-template-list .charitable-template-list-container > div:last-child").after(e()):i.last().after(e())},showCheckTemplateList:function(){0===t("#charitable-template-list .charitable-template-list-container-item.blank:not(.charitable-hidden)").length?(t("#charitable-template-list .charitable-template-list-section-blank").addClass("charitable-hidden"),t("#charitable-template-list .charitable-template-list-section-prebuilt").addClass("charitable-hidden")):(t("#charitable-template-list .charitable-template-list-section-blank").removeClass("charitable-hidden"),t("#charitable-template-list .charitable-template-list-section-prebuilt").removeClass("charitable-hidden")),0===t("#charitable-template-list .charitable-template-list-container-item.prebuilt:not(.charitable-hidden)").length?t("#charitable-template-list .charitable-template-list-section-prebuilt").addClass("charitable-hidden"):t("#charitable-template-list .charitable-template-list-section-prebuilt").removeClass("charitable-hidden"),t("#charitable-template-list .charitable-template-list-container-item.prebuilt:not(.charitable-hidden)").length>0&&0===t("#charitable-template-list .charitable-template-list-container-item.blank:not(.charitable-hidden)").length&&t("#charitable-template-list .charitable-template-list-section-prebuilt").addClass("charitable-hidden")},initStatusButton:function(e="",a=""){var l=t("ul#charitable-status-dropdown");""==e&&i.formStatus.length>0&&(e=i.formStatus),""==a&&i.formStatusLabel.length>0&&(a=i.formStatusLabel),l.addClass("charitable-hidden"),t("#charitable-status-button").removeClass("active"),t("#charitable-status-button span.text").html(a),t("#charitable-status-button").attr("data-status",e),l.find("a").removeClass("charitable-hidden"),l.find("a.switch-"+e).addClass("charitable-hidden"),l.find("a."+e).addClass("charitable-hidden")},initTemplatePanel:function(){t("#charitable-template-container").on("keyup","#charitable-setup-template-search",c.searchTemplate).on("click",".charitable-setup-templates-categories li",c.selectCategory),i.didInitHTMLEditorFields||(t(".campaign-builder-htmleditor").each(function(){c.initHTMLEditorFields(t(this))}),t(".campaign-builder-htmleditor-min").each(function(){c.initHTMLEditorFields(t(this),!0)}),i.didInitHTMLEditorFields=!0),r.$templatePreview.on("click",".charitable-template-lite-to-pro a.button, .charitable-setup-templates-feedback a.send-feedback",function(e){e.preventDefault(),t(".charitable-panel-content-wrap").animate({scrollTop:0},500),t(".charitable-template-list-container").addClass("disabled"),t(".charitable-feedback-form-container").after('<div id="charitable-builder-underlay" class="charitable-builder-underlay"></div>'),t(".charitable-feedback-form-container").css("opacity","100").css("visibility","visible"),t(".charitable-feedback-form-container").find(".charitable-feedback-form-interior").removeClass("charitable-hidden"),t(".charitable-feedback-form-container").find("textarea").val(""),t(".charitable-feedback-form-interior-confirmation").addClass("charitable-hidden")}),n.on("click","#charitable-feedback-form .charitable-templates-close-icon, #charitable-feedback-form-confirmation .charitable-templates-close-icon",function(e){e.preventDefault(),t(".charitable-template-list-container").removeClass("disabled"),t(".charitable-builder-underlay").remove(),t("#charitable-panel-template .charitable-feedback-form-container").css("opacity","0").css("visibility","hidden")}),n.on("click",".template-buttons a.preview-campaign",function(e){e.preventDefault(),t(".charitable-template-list-container").addClass("disabled"),t(".charitable-feedback-form-container").after('<div id="charitable-builder-underlay" class="charitable-builder-underlay"></div>');const a=t(this).closest(".charitable-template"),i=void 0!==a.data("template-label")?a.data("template-label"):"",l=void 0!==a.data("template-description")?a.data("template-description"):"",n=void 0!==a.data("template-preview-url")?a.data("template-preview-url"):"",r=void 0!==a.data("template-code")?a.data("template-code"):"";t("#charitable-builder-modal-template-preview").find("h4").html(i),t("#charitable-builder-modal-template-preview").find(".charitable-templates-preview-description").html("<p>"+l+"</p>"),t("#charitable-builder-modal-template-preview").find("img").attr("src",n),t("#charitable-builder-modal-template-preview").find("img").attr("alt",i),t("#charitable-builder-modal-template-preview").find("a.button-link").attr("data-template-id",r),t(".charitable-builder-modal.charitable-builder-modal-template-preview").addClass("active")}),n.on("click","#charitable-templates-preview-form .charitable-templates-close-icon",function(e){e.preventDefault(),t(".charitable-template-list-container").removeClass("disabled"),t("#charitable-builder-underlay").remove(),t(".charitable-builder-modal.charitable-builder-modal-template-preview").removeClass("active")}),r.$templatePreview.on("click","nav.charitable-template-tabs a",function(e){e.preventDefault();var a=t(this),i=!!a.data("template-tab-filter")&&a.data("template-tab-filter"),l=r.$templatePreview.find(".charitable-template-list ");r.$templatePreview.find("nav.charitable-template-tabs a").removeClass("active"),a.addClass("active"),l.find(".charitable-template").removeClass("hidden"),i&&l.find('.charitable-template[data-template-type!="'+i+'"]').addClass("hidden")}),r.$templatePreview.on("click","a.charitable-trigger-blank",function(e){e.preventDefault(),t("#charitable-template-list .charitable-template-upgrade-banner").remove(),r.$templatePreview.find("#charitable-setup-template-search").val("simple").trigger("keyup").addClass("highlighted").addClass("with-x"),r.$templatePreview.find(".charitable-setup-templates-categories").find("li[data-category=all").click(),c.showCheckTemplateList(),c.showUpgradeBanner()}),r.$templatePreview.on("click","i.fa-close",function(e){r.$templatePreview.find("#charitable-setup-template-search").val("").trigger("keyup").removeClass("highlighted")}),r.$templatePreview.on("click",".button.create-campaign",function(a){a.preventDefault(),c.hasTemplate()?t.confirm({title:charitable_builder.heads_up,content:"<p>"+charitable_builder.error_already_started_campaign+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){i.templateID=t(this).closest(".charitable-template").data("template-code"),i.templateLabel=t(this).closest(".charitable-template").data("template-label"),i.primaryThemeColorBase=i.primaryThemeColor=t(this).closest(".charitable-template").data("template-primary"),i.secondaryThemeColorBase=i.secondaryThemeColor=t(this).closest(".charitable-template").data("template-secondary"),i.tertiaryThemeColorBase=i.tertiaryThemeColor=t(this).closest(".charitable-template").data("template-tertiary"),i.buttonThemeColorBase=i.buttonThemeColor=t(this).closest(".charitable-template").data("template-button"),r.$primaryThemeColorBase.val(i.primaryThemeColorBase),r.$secondaryThemeColorBase.val(i.secondaryThemeColorBase),r.$tertiaryThemeColorBase.val(i.tertiaryThemeColorBase),r.$buttonThemeColorBase.val(i.buttonThemeColorBase),t('input[name="layout__advanced__theme_color_primary"]').val(i.primaryThemeColor),t('input[name="layout__advanced__theme_color_secondary"]').val(i.secondaryThemeColor),t('input[name="layout__advanced__theme_color_tertiary"]').val(i.tertiaryThemeColor),t('input[name="layout__advanced__theme_color_button"]').val(i.buttonThemeColor),e.querySelector('input[name="layout__advanced__theme_color_primary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_secondary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_tertiary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_button"]').dispatchEvent(new Event("input",{bubbles:!0})),c.restartForm(i.templateID,null,i.templateLabel),c.restartTemplateScreen(i.templateID)}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}}):(i.templateID=t(this).closest(".charitable-template").data("template-code"),i.templateLabel=t(this).closest(".charitable-template").data("template-label"),i.primaryThemeColorBase=i.primaryThemeColor=t(this).closest(".charitable-template").data("template-primary"),i.secondaryThemeColorBase=i.secondaryThemeColor=t(this).closest(".charitable-template").data("template-secondary"),i.tertiaryThemeColorBase=i.tertiaryThemeColor=t(this).closest(".charitable-template").data("template-tertiary"),i.buttonThemeColorBase=i.buttonThemeColor=t(this).closest(".charitable-template").data("template-button"),r.$primaryThemeColorBase.val(i.primaryThemeColorBase),r.$secondaryThemeColorBase.val(i.secondaryThemeColorBase),r.$tertiaryThemeColorBase.val(i.tertiaryThemeColorBase),r.$buttonThemeColorBase.val(i.buttonThemeColorBase),t('input[name="layout__advanced__theme_color_primary"]').val(i.primaryThemeColor),t('input[name="layout__advanced__theme_color_secondary"]').val(i.secondaryThemeColor),t('input[name="layout__advanced__theme_color_tertiary"]').val(i.tertiaryThemeColor),t('input[name="layout__advanced__theme_color_button"]').val(i.buttonThemeColor),e.querySelector('input[name="layout__advanced__theme_color_primary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_secondary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_tertiary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_button"]').dispatchEvent(new Event("input",{bubbles:!0})),c.updateTemplateID(i.templateID,i.templateLabel),c.unforceTemplateSelect(),c.enableFormActions(),c.restartForm(i.templateID,"design",i.templateLabel),c.restartTemplateScreen(i.templateID),i.didInitHTMLEditorFields||(t(".campaign-builder-htmleditor").each(function(){c.initHTMLEditorFields(t(this))}),t(".campaign-builder-htmleditor-min").each(function(){c.initHTMLEditorFields(t(this),!0)}),i.didInitHTMLEditorFields=!0),CharitableUtils.triggerEvent(l,"charitableCampaignFormScreen",[i.templateID]))}),l.on("click",".button-preview-create-campaign",function(e){e.preventDefault();var a=t(this).data("template-id");""!==a&&(t(".charitable-template-list-container").removeClass("disabled"),t("#charitable-builder-underlay").remove(),t(".charitable-builder-modal.charitable-builder-modal-template-preview").removeClass("active"),t('#charitable-template-list .charitable-template[data-template-code="'+a+'"] .button.update-campaign').length>0?r.$templatePreview.find(".charitable-template-list-container-item.charitable-template-"+a+" .button.update-campaign").click():r.$templatePreview.find(".charitable-template-list-container-item.charitable-template-"+a+" .button.create-campaign").click())}),l.on("click",".button-preview-update-campaign",function(e){e.preventDefault();var a=t(this).data("template-id");""!==a&&(t(".charitable-template-list-container").removeClass("disabled"),t("#charitable-builder-underlay").remove(),t(".charitable-builder-modal.charitable-builder-modal-template-preview").removeClass("active"),t('#charitable-template-list .charitable-template[data-template-code="'+a+'"] .button.update-campaign').length>0?r.$templatePreview.find(".charitable-template-list-container-item.charitable-template-"+a+" .button.update-campaign").click():r.$templatePreview.find(".charitable-template-list-container-item.charitable-template-"+a+" .button.create-campaign").click())}),r.$templatePreview.on("click",".button.update-campaign",function(a){a.preventDefault();var l=t(this);c.hasTemplate()&&t.confirm({title:charitable_builder.heads_up,content:"<p>"+charitable_builder.error_already_started_campaign+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){i.templateID=l.closest(".charitable-template").data("template-code"),i.templateLabel=l.closest(".charitable-template").data("template-label"),c.updateTemplateID(i.templateID,i.templateLabel),i.primaryThemeColorBase=i.primaryThemeColor=l.closest(".charitable-template").data("template-primary"),i.secondaryThemeColorBase=i.secondaryThemeColor=l.closest(".charitable-template").data("template-secondary"),i.tertiaryThemeColorBase=i.tertiaryThemeColor=l.closest(".charitable-template").data("template-tertiary"),i.buttonThemeColorBase=i.buttonThemeColor=l.closest(".charitable-template").data("template-button"),r.$primaryThemeColorBase.val(i.primaryThemeColorBase),r.$secondaryThemeColorBase.val(i.secondaryThemeColorBase),r.$tertiaryThemeColorBase.val(i.tertiaryThemeColorBase),r.$buttonThemeColorBase.val(i.buttonThemeColorBase),t('input[name="layout__advanced__theme_color_primary"]').val(i.primaryThemeColor),t('input[name="layout__advanced__theme_color_secondary"]').val(i.secondaryThemeColor),t('input[name="layout__advanced__theme_color_tertiary"]').val(i.tertiaryThemeColor),t('input[name="layout__advanced__theme_color_button"]').val(i.buttonThemeColor),e.querySelector('input[name="layout__advanced__theme_color_primary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_secondary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_tertiary"]').dispatchEvent(new Event("input",{bubbles:!0})),e.querySelector('input[name="layout__advanced__theme_color_button"]').dispatchEvent(new Event("input",{bubbles:!0})),t("#charitable-template-list .charitable-template").removeClass("active"),t("#charitable-template-list .charitable-banner-container").each(function(){t(this).addClass("charitable-hidden"),t(this).parent().find(".template-buttons").removeClass("charitable-hidden")}),l.closest(".charitable-template").addClass("active"),l.closest(".charitable-template").find(".template-buttons").addClass("charitable-hidden"),l.closest(".charitable-template").find(".charitable-banner-container").removeClass("charitable-hidden"),t(".charitable-setup-desc.secondary-text strong.template-name").html(i.templateLabel),wpchar.debug("chose this path"),c.restartForm(i.templateID,"design",i.templateLabel),c.restartTemplateScreen(i.templateID)}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})}),c.showUpgradeBanner()},restartTemplateScreen:function(e=0){if(""!==e&&0!==e||(e=i.templateID),""===e||0===e)return;const a=t(".charitable-template-list-container");a.find(".template-buttons").remove(".preview-campaign"),a.find(".button.create-campaign").removeClass("create-campaign").addClass("update-campaign").html(charitable_builder.update_campaign),a.find(".charitable-template").removeClass("active"),a.find(".charitable-template .charitable-banner-container").addClass("charitable-hidden"),a.find('.charitable-template[data-template-code="'+e+'"]').addClass("active"),a.find('.charitable-template[data-template-code="'+e+'"] .charitable-banner-container').removeClass("charitable-hidden")},restartForm:function(e=0,a="design",n=!1){c.updateTemplateID(e,n),c.showLoadingOverlay();var o={action:"charitable_get_campaign_builder_template_data",id:e,title:i.campaignTitle,nonce:charitable_builder.nonce};t.post(charitable_builder.ajax_url,o,function(e){if(e.success){t("#charitable-field-options .charitable-layout-options-group-inner").find(".charitable-panel-field").remove(),t("#charitable-field-options .charitable-select-field-notice").show(),i.quilled=[],r.$nextFieldId.val(0),c.hideLoadingOverlay();var n=void 0!==e.data.preview&&e.data.preview,o=void 0!==e.data.field_options&&e.data.field_options,d=void 0!==e.data.tab_options&&e.data.tab_options,s=void 0!==e.data.advanced&&e.data.advanced;n?c.addLayoutToPreview(n):wpchar.debug("previewLayout is false or not defined"),o?c.addFieldOptions(o):wpchar.debug("previewFieldOptions is false or not defined"),d?c.addTabOptions(d):wpchar.debug("previewTabOptions is false or not defined"),s?c.addAdvancedOptions(s):wpchar.debug("previewAdvancedOptions is false or not defined"),Charitable.Admin.Builder.DragFields&&"function"==typeof Charitable.Admin.Builder.DragFields.ready&&Charitable.Admin.Builder.DragFields.ready(),c.updateFormHiddenFields(),c.updateFormHiddenFieldID(),t(".campaign-builder-htmleditor").each(function(){c.initHTMLEditorFields(t(this))}),t(".campaign-builder-htmleditor-min").each(function(){c.initHTMLEditorFields(t(this),!0)}),i.didInitHTMLEditorFields=!0,r.$preview.find(".charitable-field-section").each(function(){c.checkFieldTargetState(t(this))}),c.checkAllRecommendedFields(),c.updateGoalRelatedItems(),c.updateEndDateRelatedItems(),a&&c.panelSwitch("design"),t(".charitable-campaign-suggested-donations-mini").each(function(){c.initSuggestedDonationsMini(t(this)),c.updateSuggestdDonationsMiniRowsFromSettings(t(this))}),c.checkFieldAllow(),c.checkFieldMax(),void 0!==e.data.settings.general.description&&""!=e.data.settings.general.description&&(i.campaignDescription=e.data.settings.general.description,r.$settingsPanel.find('input[name="settings[general][description]"').val(i.campaignDescription)),c.setCampaignNotSaved(),l.trigger("charitableEditorScreenStart")}else c.formSaveError(e.data)}).fail(function(e,a,t){c.formSaveError()}).always(function(){})},checkNoFieldsPreview(e=!1){!1===e&&0===r.$preview.find('.charitable-field-section[data-section-type="fields"] .charitable-field').length&&void 0!==charitable_builder.no_field_preview?(t("#charitable-design-wrap").addClass("no-fields-mode"),l.find(".charitable-no-fields-area").hasClass("charitable-hidden")&&l.find(".charitable-no-fields-area").removeClass("charitable-hidden")):(l.find(".charitable-no-fields-area").hasClass("charitable-hidden")||l.find(".charitable-no-fields-area").addClass("charitable-hidden"),t("#charitable-design-wrap").removeClass("no-fields-mode"))},checkFieldTargetState(e=!1){!1!==e&&("fields"!==e.data("section-type")&&"tabs"!==e.data("section-type")||("fields"===e.data("section-type")?0===e.find(".charitable-field").length?e.removeClass("charitable-field-target-inactive").addClass("charitable-field-target"):e.removeClass("charitable-field-target").addClass("charitable-field-target-inactive"):"tabs"===e.data("section-type")&&(0===e.find(".tab_content_item.active .charitable-field").length?e.find(".tab_content_item.active").removeClass("empty-tab").addClass("empty-tab"):e.find(".tab_content_item.active").removeClass("empty-tab"))))},addAdvancedOptions(e){t(".charitable-layout-options-tab-advanced").find("input, select").each(function(){var a=t(this),i=a.data("advanced-field-id");void 0!==e[i]&&""!=i&&(a.is("select")?a.val(e[i]).change():a.val(e[i]))})},addFieldOptions(e){r.$fieldOptions.find(".charitable-layout-options-group-inner .charitable-select-field-notice").after(e)},addTabOptions(e){r.$fieldOptions.find(".charitable-layout-options-tab.charitable-layout-options-tab-tabs .charitable-layout-options-group-inner").html(e)},addLayoutToPreview(e){r.$preview.find(".charitable-design-wrap").replaceWith(e)},alignFieldEvents:function(e){e.on("click",".charitable-panel-field-align a",function(e){e.preventDefault();var a=t(this),i=a.closest(".charitable-panel-field"),l=""!==a.data("align-value")?a.data("align-value"):"center";i.find("span").removeClass("active"),i.find('input[type="hidden"').val(l),a.parent().addClass("active"),c.setCampaignNotSaved()})},numberSliderEvents:function(e){r.$fieldOptions.on("input change",'input[type="range"]',function(e){var a=t(this).attr("min-actual")?parseInt(t(this).attr("min-actual")):0,i=t(this).val();a>0&&(i<=a?(t(this).val(a),t(this).next().addClass("min-reach")):t(this).next().removeClass("min-reach")),c.setCampaignNotSaved()}),e.on("change input",".charitable-panel-field-number-slider input[type=range]",function(e){var a=t(e.target).siblings(".charitable-number-slider-hint");a.attr("data-hint",e.target.value),a.html(e.target.value+a.data("symbol")+"<small>minimum</small>")}),e.on("input",".charitable-field-option-row-min_max .charitable-input-row .charitable-number-slider-min",c.fieldNumberSliderUpdateMin),e.on("input",".charitable-field-option-row-min_max .charitable-input-row .charitable-number-slider-max",c.fieldNumberSliderUpdateMax),e.on("input",".charitable-number-slider-default-value",_.debounce(c.changeNumberSliderDefaultValue,500)),e.on("input",".charitable-number-slider-step",_.debounce(c.changeNumberSliderStep,500)),e.on("focusout",".charitable-number-slider-step",c.checkNumberSliderStep),e.on("input",".charitable-number-slider-value-display",_.debounce(c.changeNumberSliderValueDisplay,500)),e.on("input",".charitable-number-slider-min",_.debounce(c.changeNumberSliderMin,500)),e.on("input",".charitable-number-slider-max",_.debounce(c.changeNumberSliderMax,500))},changeNumberSliderMin:function(e){var a=t(e.target).parents(".charitable-field-option-row").data("fieldId"),i=parseFloat(e.target.value);isNaN(i)||c.updateNumberSliderDefaultValueAttr(a,e.target.value,"min")},changeNumberSliderMax:function(e){var a=t(e.target).parents(".charitable-field-option-row").data("fieldId"),i=parseFloat(e.target.value);isNaN(i)||c.updateNumberSliderDefaultValueAttr(a,e.target.value,"max").updateNumberSliderStepValueMaxAttr(a,e.target.value)},changeNumberSliderValueDisplay:function(a){var i=a.target.value,l=t(a.target).parents(".charitable-field-option-row").data("fieldId"),n=e.getElementById("charitable-field-option-"+l+"-default_value");n&&c.updateNumberSliderHintStr(l,i).updateNumberSliderHint(l,n.value)},changeNumberSliderStep:function(e){var a=parseFloat(e.target.value);if(!isNaN(a)){var i=parseFloat(e.target.max),l=parseFloat(e.target.min),n=t(e.target).parents(".charitable-field-option-row").data("fieldId");a<=0||(a>i?e.target.value=i:a<l?e.target.value=l:c.updateNumberSliderAttr(n,a,"step").updateNumberSliderDefaultValueAttr(n,a,"step"))}},checkNumberSliderStep:function(e){var a=parseFloat(e.target.value),i=t(this);!isNaN(a)&&a>0||t.confirm({title:charitable_builder.heads_up,content:charitable_builder.error_number_slider_increment,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){i.val("").trigger("focus")}}}})},changeNumberSliderDefaultValue:function(e){var a=parseFloat(e.target.value);if(!isNaN(a)){var i=parseFloat(e.target.max),l=parseFloat(e.target.min),n=t(e.target).parents(".charitable-field-option-row-default_value").data("fieldId");if(a>i)return void(e.target.value=i);if(a<l)return void(e.target.value=l);c.updateNumberSlider(n,a).updateNumberSliderHint(n,a)}},updateNumberSliderDefaultValueAttr:function(a,i,l){var n=e.getElementById("charitable-field-option-"+a+"-default_value");if(n){var r=parseFloat(n.value);n.setAttribute(l,i),i=parseFloat(i),"max"===l&&r>i&&(n.value=i,t(n).trigger("input")),"min"===l&&r<i&&(n.value=i,t(n).trigger("input"))}return this},updateNumberSlider:function(a,t){var i=e.getElementById("charitable-number-slider-"+a);return i&&(i.value=t),this},updateNumberSliderAttr:function(a,t,i){var l=e.getElementById("charitable-number-slider-"+a);return l&&l.setAttribute(i,t),this},updateNumberSliderHintStr:function(a,t){var i=e.getElementById("charitable-number-slider-hint-"+a);return i&&(i.dataset.hint=t),this},updateNumberSliderHint:function(a,t){var i=e.getElementById("charitable-number-slider-hint-"+a);return i&&(i.innerHTML=wpchar.sanitizeHTML(i.dataset.hint).replace("{value}","<b>"+t+"</b>")),this},fieldNumberSliderUpdateMin:function(e){var a=t(e.target).parents(".charitable-field-option-row-min_max"),i=parseFloat(a.find(".charitable-number-slider-max").val()),n=parseFloat(e.target.value);if(!isNaN(n)){if(i<=n)return e.preventDefault(),void(this.value=i);var r=a.data("field-id");l.find("#charitable-field-"+r+' input[type="range"]').attr("min",n)}},fieldNumberSliderUpdateMax:function(e){var a=t(e.target).parents(".charitable-field-option-row-min_max"),i=parseFloat(a.find(".charitable-number-slider-min").val()),n=parseFloat(e.target.value);if(!isNaN(n)){if(i>=n)return e.preventDefault(),void(this.value=i);var r=a.data("field-id");l.find("#charitable-field-"+r+' input[type="range"]').attr("max",n)}},updateNumberSliderStepValueMaxAttr:function(a,i){var l=e.getElementById("charitable-field-option-"+a+"-step");if(l){var n=parseFloat(l.value);l.setAttribute("max",i),n>(i=parseFloat(i))&&(l.value=i,t(l).trigger("input"))}return this},isVisitedViaBackButton:function(){if(!performance)return!1;var e=!1;return performance.getEntriesByType("navigation").forEach(function(a){"back_forward"===a.type&&(e=!0)}),e},hideLoadingOverlay:function(){var e=t("#charitable-builder-overlay");e.addClass("fade-out"),setTimeout(function(){e.hide()},200)},initCodeEditor:function(){if(t(".campaign-builder-codeeditor").length>0){var e="";t(".campaign-builder-codeeditor").each(function(){-1!==t(this).attr("id").indexOf("charitable-panel-field-settings-field_html_html_")&&(e=t(this).attr("id").replace("charitable-panel-field-settings-field_html_html_",""),wpchar.debug("field_id: "+e),l.trigger("charitableFieldAddHTML",[e,"html"]))})}},showLoadingOverlay:function(){var e=t("#charitable-builder-overlay");e.removeClass("fade-out"),e.show()},updateFormUI:function(e=!1,a=!1){var l=!1;l=(l="title"===e?a:t("input.charitable-form-name").val()).replace(/[^a-z0-9 _.,!"'/$]/gi,""),r.$campaignNameTopBanner=t("input.charitable-form-name"),r.$campaignNamePreview=t(".charitable-preview .charitable-form-name"),r.$campaignNameFieldTitleSettings=t("input.charitable-campaign-builder-title"),r.$campaignNameTopBanner.val(l),r.$campaignNamePreview.html(l),r.$campaignNameFieldTitleSettings.val(l),r.$preview.find(".charitable-field-campaign-title .charitable-campaign-builder-placeholder-preview-text").html('<h1 class="charitable-campaign-title">'+l+"</h1>"),"title"===e&&(i.campaignTitle=l,c.resizeTopCampaignTitleInputBox())},bindUIActions:function(){c.bindAutoResizeCampaignTitle(),c.bindUIEditCampaignTitle(),c.bindCampaignTitleBlockTextField(),c.bindUIActionsPanels(),c.bindUIActionsFields(),c.bindUIActionsPreview(),c.bindUIActionsSaveExit(),c.bindUIActionsGeneral(),c.bindUITabs(),l.on("change","input, textarea, select, checkbox, radio",function(e){c.setCampaignNotSaved()}),c.bindUILayoutOptionsAdvanced(),c.bindUISettingsRevealGroups(),c.bindUIMoneyTextFields(),c.checkFieldConditionals(),l.on("change","select#charitable-panel-field-settings-campaign_campaign_creator_id",function(e){c.updateCampaignCreatorInfo()}),l.on("click","div#charitable-marketing-form a.button-link, div#charitable-payment-form a.button-link, div#charitable-feedback-form a.button-link",function(e){e.preventDefault(),c.initFeedbackForms(t(this))}),l.on("click","a.send-feedback",function(e){e.preventDefault(),t(".charitable-panel-content-wrap").animate({scrollTop:0},500),t(".charitable-template-list-container").addClass("disabled"),t(".charitable-feedback-form-container").after('<div id="charitable-builder-underlay" class="charitable-builder-underlay"></div>'),t(".charitable-feedback-form-container").css("opacity","100").css("visibility","visible"),t(".charitable-feedback-form-container").find(".charitable-feedback-form-interior").removeClass("charitable-hidden"),t(".charitable-feedback-form-container").find("textarea").val(""),t(".charitable-feedback-form-interior-confirmation").addClass("charitable-hidden")}),l.on("keyup","table.charitable-campaign-suggested-donations-mini input",function(e){var a=parseInt(t(this).closest(".charitable-panel-field").data("field-id"));if(a>0){var i=t(this).index('.charitable-panel-field[data-field-id="'+a+'"] table.charitable-campaign-suggested-donations-mini input[type="text"].campaign_suggested_donations');c.updateSuggestDonationsSettings(t(this),i)}}),l.on("change keyup blur input",'table.charitable-campaign-suggested-donations input[type="text"].campaign_suggested_donations',function(e){var a=t(this).index('.charitable-campaign-suggested-donations input[type="text"].campaign_suggested_donations');t(this).attr("name").indexOf("recurring")<1&&c.updateSuggestDonationsSettings(t(this),a)}),l.on("change",'.charitable-campaign-builder-allow-custom-donations input[type="checkbox"]',function(e){t('.charitable-campaign-builder-allow-custom-donations input[type="checkbox"]').prop("checked",t(this).is(":checked")),c.updateAllowCustomDonationSettings(t(this).is(":checked"))}),l.on("change",'input[type="radio"].campaign_suggested_donations',function(e){parseInt(t(this).closest(".charitable-panel-field").data("field-id"));t(this).attr("name").indexOf("recurring")<1&&c.updateSuggestedDonationAmountDefault(t(this).val())}),c.bindUIInputRange(),l.on("click",".education-buttons button.update-to-pro-link",function(e){t(this).prev("a").length>0?a.open(t(this).prev("a").attr("href"),"_blank"):a.open("https://wpcharitable.com/lite-vs-pro/","_blank")})},bindUILayoutOptionsAdvanced:function(){l.on("change","select#charitable-design-layout-options-advanced-tab-style",function(e){e.preventDefault();var a=t(this),i=t("nav.charitable-campaign-preview-nav");t(a).find("option").each(function(){i.removeClass("tab-style-"+this.value)}),i.addClass("tab-style-"+a.find(":selected").val())}),l.on("change","select#charitable-design-layout-options-advanced-tab-size",function(e){e.preventDefault();var a=t(this),i=t("nav.charitable-campaign-preview-nav");t(a).find("option").each(function(){i.removeClass("tab-size-"+this.value)}),i.addClass("tab-size-"+a.find(":selected").val())})},tabGroupsAdd:function(e,a){if(a.preventDefault(),r.$sortableTabContent.find(".tab_content_item").length>=i.maxNumberOfTabs)c.formGenericNotice("You cannot have more than "+i.maxNumberOfTabs+" tabs in your campaign template.");else{var n=t(e),o=n.parent().find(".charitable-group.charitable-layout-options-tab-group.hidden").last().clone(),d=r.$preview.find(".tab-content"),s="html",p=t(".charitable-group.charitable-layout-options-tab-group").map(function(){return parseInt(t(this).attr("data-group_id"))}).get(),h=Math.max.apply(null,p)+1;void 0!==h?(o.attr("data-group_id",h),o.attr("data-tab-id",h),o.find(".charitable-group-row").attr("data-tab-id",h),o.find("input, select, textarea, label").each(function(e){var a=t(this),i=a.attr("for"),l=a.attr("name"),n=a.attr("id");void 0!==n&&!1!==n&&a.attr("id",a.attr("id").replace("_xxx_","_"+h+"_")),void 0!==l&&!1!==l&&a.attr("name",a.attr("name").replace("_xxx_","_"+h+"_")),void 0!==i&&!1!==i&&a.attr("for",a.attr("for").replace("_xxx_","_"+h+"_"))}),o.find('input[name="tabs__'+h+'__title"]').val("New Tab"),o.find('textarea[name="tabs__'+h+'__desc"]').html("Content"),t(".charitable-layout-options-tab-group").removeClass("active"),o.addClass("active"),o.removeClass("charitable-closed").addClass("charitable-open").removeClass("hidden").find(".charitable-angle-right").removeClass("charitable-angle-right").addClass("charitable-angle-down"),n.before(o),c.bindUIActionPanelsTabs(),c.checkHideTabNavigation(),t("nav.charitable-campaign-preview-nav ul li").removeClass("active"),d.find("ul li").removeClass("active"),t("nav.charitable-campaign-preview-nav ul").append('<li data-tab-type="html" data-tab-id="'+h+'" class="tab_title active" id="tab_'+h+'_title"><a href="#">'+charitable_builder.new_tab+"</a></li>"),d.find("ul").append('<li id="tab_'+h+'_content" class="tab_content_item empty-tab active tab_type_'+s+'" data-tab-type="'+s+'" data-tab-id="'+h+'"><div class="charitable-tab-wrap ui-sortable"><p class="empty-tab-notice">'+charitable_builder.empty_tab+"</p></div></li>"),d.removeClass("empty-tabs"),d.find(".no-tab-notice").remove(),l.trigger("charitableAddNewTab",h)):c.formGenericError("Error ecountered attempting to add another tab.")}},bindUITabs:function(){l.on("click","button.charitable-tab-groups-add",function(e){c.tabGroupsAdd(this,e)}),l.find(".charitable-layout-options-tab-tabs .charitable-layout-options-group-inner").sortable({handle:".charitable-draggable",update:function(e,a){var i=t(".charitable-group.charitable-layout-options-tab-group").map(function(){if(!t(this).hasClass("hidden"))return parseInt(t(this).attr("data-group_id"))}).get(),l=t(".charitable-group.charitable-layout-options-tab-group").map(function(){if(t(this).hasClass("active"))return parseInt(t(this).attr("data-group_id"))}).get();t("nav.charitable-campaign-preview-nav ul").empty(),i.forEach(function(e){var a=t("#charitable-field-options").find('[data-group_id="'+e+'"]'),i=e,n=l.indexOf(e)>=0?"active":"",r=0!==e&&""!==a.find('input[name="tabs__'+i+'__type"').val()?a.find('input[name="tabs__'+i+'__type"').val():"html",o=a.find('input[name="tabs__'+i+'__title"').val();t("nav.charitable-campaign-preview-nav ul").append('<li data-tab-type="'+r+'" data-tab-id="'+e+'" class="tab_title '+n+'" id="tab_'+e+'_title"><a href="#">'+o+"</a></li>")})}}),l.on("click","input, select, textarea, .ql-editor",".charitable-layout-options-tab-tabs .charitable-layout-options-group-inner .charitable-layout-options-tab-group",function(e){if(!t(this).closest(".charitable-layout-options-tab-group").hasClass("active")){var a=t(this).closest(".charitable-layout-options-tab-group").data("group_id");t('.charitable-preview nav.charitable-campaign-preview-nav li[data-tab-id="'+a+'"] a').click()}}),l.on("click","a.charitable-configure-tab-settings",function(e){c.fieldTabToggle("layout-options"),t(".charitable-layout-options-tab").removeClass("active"),t(".charitable-layout-options-tab.charitable-layout-options-tab-tabs").addClass("active")}),l.on("click","nav li.tab_title a",function(e){e.preventDefault();var a=t(".charitable-campaign-preview"),i=t(this).parent().data("tab-id");a.find("li#tab_"+i+"_title").attr("data-tab-type");t(".tab-content ul li").removeClass("active"),t("nav li.tab_title").removeClass("active"),t(this).parent().addClass("active"),t(".tab-content ul li#tab_"+i+"_content").addClass("active"),t(".charitable-layout-options-tab").removeClass("active"),t(".charitable-layout-options-tab.charitable-layout-options-tab-tabs").addClass("active"),t(".charitable-layout-options-tab").find(".charitable-layout-options-tab-group").each(function(){t(this).removeClass("charitable-open"),"true"===wpCookies.get("charitable_panel_layout_options_tabs_tab_open_"+t(this).data("group_id"))?(t(this).addClass("charitable-open"),t(this).find(".charitable-general-layout-heading a.charitable-toggleable-group i").addClass("charitable-angle-down"),t(this).find(".charitable-general-layout-heading a.charitable-toggleable-group i").removeClass("charitable-angle-right"),t(this).removeClass("charitable-closed")):(t(this).removeClass("charitable-open"),t(this).find(".charitable-general-layout-heading a.charitable-toggleable-group i").removeClass("charitable-angle-down"),t(this).find(".charitable-general-layout-heading a.charitable-toggleable-group i").addClass("charitable-angle-right"),t(this).addClass("charitable-closed"))}),t(".charitable-layout-options-tab .charitable-group").removeClass("active"),t(".charitable-layout-options-tab").find("[data-group_id="+i+"]").addClass("active").removeClass("charitable-closed"),t(".charitable-layout-options-tab").find("[data-group_id="+i+"]").find(".charitable-group-rows").show(),t(".charitable-layout-options-tab").find("[data-group_id="+i+"]").find(".charitable-toggleable-group i").removeClass(".charitable-angle-right").addClass("charitable-angle-down"),t("#layout-options a").click(),t("#charitable-preview-tab-container").addClass("active"),wpCookies.set("charitable_panel_tab_section_tab_id",i,2592e3),wpCookies.set("charitable_panel_layout_options_tabs_tab_open_"+i,!0,2592e3),wpCookies.set("charitable_panel_content_section","",2592e3),wpCookies.set("charitable_panel_active_field_id","",2592e3)}),l.on("change",".charitable-group select.tab_type",function(e){e.preventDefault();var a=t(this),i=a.closest(".charitable-group").data("group_id"),l=t(".charitable-campaign-preview"),n=a.val();l.find("nav li.tab_title[data-tab-id="+i+"]").attr("data-tab-type",n),l.find("div.tab-content ul li#tab_"+i+"_content").attr("data-tab-type",n),l.find("div.tab-content ul li#tab_"+i+"_content").removeClass(function(e,a){return(a.match(/(^|\s)tab_type_\S+/g)||[]).join(" ")}),l.find("div.tab-content ul li#tab_"+i+"_content").addClass("tab_type_"+n);var r={action:"charitable_tab_content_preview",type:n,group_id:i,nonce:charitable_builder.nonce};return t.post(charitable_builder.ajax_url,r,function(e){e.success?l.find("div.tab-content ul li#tab_"+i+"_content").html(e.data.output):c.formSaveError(e.data)}).fail(function(e,a,t){c.formSaveError()}).always(function(){})}),l.on("input","input#charitable-panel-field-settings-charitable-campaign-enable-tabs",function(e){t(this).is(":checked")?(t("#charitable-preview-tab-container").addClass("disabled"),t("#charitable-design-layout-options-advanced-tab-style").prop("disabled",!0).addClass("disabled"),t("#charitable-design-layout-options-advanced-tab-size").prop("disabled",!0).addClass("disabled")):(t("#charitable-preview-tab-container").removeClass("disabled"),t("#charitable-design-layout-options-advanced-tab-style").prop("disabled",!1).removeClass("disabled"),t("#charitable-design-layout-options-advanced-tab-size").prop("disabled",!1).removeClass("disabled"))}),l.on("input","input.charitable-settings-tab-visible-nav",function(e){const a=t(this).is(":checked"),i=t(this).closest(".charitable-tab-title-row").data("tab-id");a?r.$preview.find("nav li#tab_"+i+"_title").addClass("charitable-tab-hide"):r.$preview.find("nav li#tab_"+i+"_title").removeClass("charitable-tab-hide")}),l.on("keydown",'.charitable-tab-title-row input[type="text"]',function(e){var a=e.keyCode||e.which;(!(a>=65&&a<=90||a>=96&&a<=105||a>=35&&a<=40||32==a||e.ctrlKey&&65==a||e.ctrlKey&&67==a||e.ctrlKey&&88==a||e.ctrlKey&&86==a||e.metaKey&&65==a||e.metaKey&&67==a||e.metaKey&&88==a||e.metaKey&&86==a||a>=96&&a<=105||110==a||190==a||a>=37&&a<=40||46==a||173==a||8==a||a>=48&&a<=57)||e.ctrlKey&&e.altKey)&&e.preventDefault()}),l.on("change",'.charitable-tab-title-row input[type="text"]',function(e){""===t(this).val().trim()&&t(this).val("New Tab")})},bindUIInputRange:function(){l.on("mouseenter",'input[type="range"].charitable-indicator-on-hover, .charitable-panel-field-align a',function(e){var a=parseInt(t(this).closest(".charitable-panel-field").data("field-id"));a>0&&r.$preview.find("#charitable-field-"+a+" .charitable-preview-field-indicator").removeClass("charitable-hidden")}),l.on("mouseleave",'input[type="range"].charitable-indicator-on-hover, .charitable-panel-field-align a',function(e){var a=parseInt(t(this).closest(".charitable-panel-field").data("field-id"));a>0&&r.$preview.find("#charitable-field-"+a+" .charitable-preview-field-indicator").addClass("charitable-hidden")})},bindAutoResizeCampaignTitle:function(){l.on("input","input#charitable_settings_title",function(e){var a=t(this).val(),i=a.length;wpchar.debug(a),wpchar.debug(i),wpchar.debug(t("#charitable_settings_title").val()),c.setCampaignNotSaved(),c.updateFormUI("title",a),c.resizeTopCampaignTitleInputBox()}),l.on("focusout","input#charitable_settings_title",function(e){})},resizeTopCampaignTitleInputBox:function(){},bindCampaignTitleBlockTextField:function(){l.on("keyup","input.charitable-campaign-builder-title",function(e){c.updateFormUI("title",t(this).val())})},bindUIEditCampaignTitle:function(){},allowTitleUpdate:function(e){e.hasClass("edit")?(t("#charitable_settings_title").attr("disabled",!0),e.removeClass("edit")):(t("#charitable_settings_title").removeAttr("disabled"),e.addClass("edit"),t("#charitable_settings_title").focus().select())},bindUIActionsPanels:function(){l.on("click","#charitable-panels-toggle button:not(.charitable-panel-help-button), .charitable-panel-switch",function(e){e.preventDefault(),t(this).hasClass("disabled")||c.panelSwitch(t(this).data("panel"))}),l.on("click",".charitable-panel-help-button, #charitable-panels-toggle a:has(.charitable-panel-help-button)",function(e){var i=t(this).closest("a");if(i.length||(i=t(this).is("a")?t(this):t(this).closest("a")),i.length&&i.attr("href")){e.stopPropagation(),e.stopImmediatePropagation();var l=i.attr("href"),n=i.attr("target")||"_blank";return"_blank"===n?a.open(l,n):a.location.href=l,!1}}),l.on("click",".charitable-panel .charitable-panel-sidebar-section:not(.charitable-need-upgrade):not(.charitable-not-available):not(.charitable-not-installed):not(.charitable-not-activated):not(.charitable-installed-refresh):not(.charitable-not-available):not(.charitable-addon-file-missing)",function(e){c.panelSectionSwitch(this,e)}),l.on("click",".charitable-panels .charitable-panel-sidebar-content .charitable-panel-sidebar-toggle",function(){t(this).parent().toggleClass("charitable-panel-sidebar-closed")}),l.on("focusout",'input[name="tabs__campaign__title"]',function(e){e.preventDefault(),c.updateFormUI("tabs__campaign__title",t(this).val())}),c.bindUIActionPanelsTabs()},bindUIActionPanelsTabs:function(){l.on("input",'.charitable-tab-title-row input[type="text"]',function(e){e.preventDefault();var a=t(this),i=a.closest(".charitable-group"),l=i.attr("data-group_id"),n=0===a.val().length?"New Tab":a.val(),r=c.removeTags(n);i.find(".charitable-general-layout-heading").find("span").html(r),t("nav.charitable-campaign-preview-nav ul").find("#tab_"+l+"_title a").html(r)})},checkHideTabNavigation:function(){t("#charitable-field-options .charitable-layout-options-tab-group").length-1>1?t("#charitable-field-options").find("input.charitable-settings-tab-visible-nav").each(function(){t(this).prop("checked",!1).attr("disabled",!0),t(this).parent().find("label").addClass("charitable-disabled"),r.$preview.find("nav.charitable-campaign-preview-nav li").removeClass("charitable-tab-hide")}):t("#charitable-field-options").find("input.charitable-settings-tab-visible-nav").each(function(){t(this).removeAttr("disabled"),t(this).parent().find("label").removeClass("charitable-disabled")})},removeTags:function(e){return e},panelSwitch:function(e){var a=t("#charitable-panel-"+e),i=t(".charitable-panel-"+e+"-button");if((c.hasTemplate()||"template"===e)&&!a.hasClass("active")){if(CharitableUtils.triggerEvent(l,"charitablePanelSwitch",[e]).isDefaultPrevented()||!charitable_panel_switch)return!1;t("#charitable-panels-toggle").find("button").removeClass("active"),t(".charitable-panel").removeClass("active"),i.addClass("active"),a.addClass("active"),history.replaceState({},null,wpchar.updateQueryString("view",e)),l.trigger("charitablePanelSwitched",[e]),wpCookies.set("charitable_panel",e,2592e3),wpCookies.set("charitable_panel_content_section","",2592e3),wpCookies.set("charitable_panel_active_field_id","",2592e3)}},panelSectionSwitch:function(e,a){a&&a.preventDefault();var i=t(e),l=i.parent().parent(),n=i.data("section"),r=l.find(".charitable-panel-sidebar-section"),o=l.find(".charitable-panel-sidebar-section-"+n);i.hasClass("upgrade-modal")||i.hasClass("education-modal")||o.hasClass("active")||c.panelSectionSwitchTo(n,l,r,o)},panelSectionSwitchTo:function(e,a,t,i){if(CharitableUtils.triggerEvent(l,"charitablePanelSectionSwitch",e).isDefaultPrevented()||!charitable_panel_switch)return!1;t.removeClass("active"),i.addClass("active"),a.find(".charitable-panel-content-section").hide(),a.find(".charitable-panel-content-section-"+e).show();wpCookies.set("charitable_panel_content_section",e,2592e3)},bindUIActionsFields:function(){l.on("click",".charitable-tab a",function(e){e.preventDefault(),c.fieldTabToggle(t(this).parent().attr("id")),"add-layout"===t(this).parent().attr("id")&&c.resetPreviewArea()}),l.on("click",".charitable-layout-options-tab-tabs .charitable-toggleable-group",function(e){e.preventDefault(),c.fieldGroupTogglev2(t(this),"click")}),l.on("click",".charitable-add-fields .charitable-toggleable-group",function(e){e.preventDefault(),c.fieldGroupTogglev3(t(this),"click")}),l.on("click",".charitable-tab-group-delete",function(e){if(e.preventDefault(),e.stopPropagation(),!c.isFormPreviewActionsDisabled(this)){var a=t(this).closest(".charitable-group").attr("data-group_id");c.tabDelete(a)}}),l.on("click",".charitable-field",function(e){e.target.classList.contains("charitable-dismiss-button")||(e.stopPropagation(),t(this).find(".charitable-field-edit").click())}),l.on("click",".charitable-field-delete",function(e){e.preventDefault(),e.stopPropagation();var a=!t(this).parent().hasClass("charitable-missing-addon-content"),i=parseInt(t(this).closest(".charitable-field").data("field-id"));c.fieldDelete(i,a)}),l.on("click",".charitable-field-duplicate",function(e){e.preventDefault(),e.stopPropagation(),c.fieldDuplicate(t(this).parent().data("field-id"))}),l.on("click",".charitable-field-edit",function(e){e.preventDefault(),e.stopPropagation(),c.resetPreviewArea(),t(this).parent().addClass("active"),t("ul.charitable-tabs li#add-layout a").removeClass("active"),t("ul.charitable-tabs li#layout-options a").addClass("active");var a=parseInt(t(this).parent().data("field-id"));wpCookies.set("charitable_panel_active_field_id",a,2592e3),c.fieldEdit(t(this).data("type"),t(this).data("section"),t(this).parent().data("field-id"),a,t(this).parent().data("field-type"))}),l.on("click",".charitable-add-fields-button",function(e){e.preventDefault();const a=t(this);if(a.hasClass("ui-draggable-disabled"))return;let i=a.data("field-type");CharitableUtils.triggerEvent(l,"charitableBeforeFieldAddOnClick",[i,a]).isDefaultPrevented()||c.fieldAdd(i,{$sortable:"default"})}),l.on("charitableFieldAdd",function(e,a,i){-1!==t.inArray(i,["campaign-title","campaign-description","campaign-overview","progress-bar","donation-options","social-sharing","social-links","photo","organizer","html","donate-button","donate-amount","campaign-summary","donate-form","donor-wall","shortcode","text","video"])&&c.fieldChoiceSortable(i,`#charitable-field-option-row-${a}-choices ul`)}),l.on("click",".charitable-group-toggle",function(e){if(CharitableUtils.triggerEvent(l,"charitableFieldOptionGroupToggle").isDefaultPrevented())return!1;e.preventDefault(),c.resetPreviewArea();var a=t(this).closest(".charitable-layout-options-tab");a.siblings(".charitable-layout-options-tab").removeClass("active"),a.addClass("active"),t(this).parent().hasClass("charitable-layout-options-tab-tabs")?t("#charitable-preview-tab-container").toggleClass("active"):t("#charitable-preview-tab-container").removeClass("active"),t(this).parent().hasClass("charitable-layout-options-tab-general")?wpCookies.set("charitable_panel_design_layout_options_group","general",2592e3):t(this).parent().hasClass("charitable-layout-options-tab-tabs")?wpCookies.set("charitable_panel_design_layout_options_group","tabs",2592e3):t(this).parent().hasClass("charitable-layout-options-tab-advanced")&&wpCookies.set("charitable_panel_design_layout_options_group","advanced",2592e3),wpCookies.set("charitable_panel_active_field_id","",2592e3),t(".charitable-layout-options-tab-general .charitable-layout-options-group-inner").html(),t(".charitable-campaign-preview .charitable-select-field").removeClass("active")}),l.on("click",".charitable-field-edit",function(e){e.preventDefault(),t("#layout-options a").addClass("active"),t(".charitable-add-fields").hide(),t(".charitable-field-options").show();var a=t(".charitable-layout-options-tab-general");a.siblings(".charitable-layout-options-tab").removeClass("active"),a.addClass("active")}),l.on("click",function(){c.focusOutEvent()}),c.photoFieldEvents(l),c.campaignSummaryEvents(l),c.socialSharingEvents(l),c.socialLinkingEvents(l),c.donateButtonEvents(l),c.donateWallEvents(l),c.progressBarEvents(l),c.shortcodeEvents(l),c.organizerEvents(l),c.cssTextFieldEvents(l),c.textFieldEvents(l),c.headlineEvents(l),c.numberSliderEvents(l),c.alignFieldEvents(l),c.highlightEvents(l),c.advancedLayoutOptionsEvents(l),c.previewHover(l),c.goalEvents(l),c.endDateEvents(l)},endDateEvents:function(e){e.on("change","#charitable-panel-field-settings-campaign_end_date",function(e){c.updateEndDateRelatedItems(t(this).val())})},updateEndDateRelatedItems:function(e="",a=t("#charitable-panel-field-settings-campaign_end_date")){""===e&&a.length&&(e=a.val()),""===e.trim()?(wpchar.debug("updateEndDateRelatedItems - no end date"),r.$preview.find(".charitable-field-campaign-summary").each(function(){var e=t(this).attr("data-field-id");t(this).find(".campaign-time-left.campaign-summary-item").addClass("charitable-hidden"),wpchar.debug(t('input[name="_fields['+e+"][show_hide][campaign_hide_time_remaining]")),r.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_time_remaining]").attr("disabled",!0).addClass("charitable-disabled").prop("checked",!1).next().addClass("charitable-disabled")})):(wpchar.debug("updateEndDateRelatedItems - there is an end date"),r.$preview.find(".charitable-field-campaign-summary").each(function(){var e=t(this).attr("data-field-id");r.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_time_remaining]").attr("disabled",!1).removeClass("charitable-disabled").next().removeClass("charitable-disabled")}))},goalEvents:function(e){e.on("change","#charitable-panel-field-settings-campaign_goal",function(e){c.updateGoalRelatedItems(t(this).val())})},updateGoalRelatedItems:function(e="",a=t("#charitable-panel-field-settings-campaign_goal")){if(wpchar.debug(e,"goalAmount"),""===e&&a.length&&(e=a.val()),""===e||"0"===e||"0.00"===e)wpchar.debug("updateGoalRelatedItems - checkpoint 0"),r.$preview.find(".charitable-field-progress-bar .progress").addClass("charitable-campaign-preview-not-available").addClass("charitable-hidden"),r.$preview.find(".charitable-field-campaign-summary").each(function(){var e=t(this).attr("data-field-id");t(this).find(".campaign-raised.campaign-summary-item").addClass("charitable-hidden"),wpchar.debug(r.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_percent_raised]")),r.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_percent_raised]").prop("checked",!1).attr("disabled",!0).addClass("charitable-disabled").next().addClass("charitable-disabled")}),r.$preview.find(".charitable-field-progress-bar .campaign-goal").each(function(){var e=t(this).find("span").html();t(this).html("<span>"+e+"</span>")});else{/^\d+\,\d+$/.test(e)?(wpchar.debug("updateGoalRelatedItems - checkpoint 1"),c.updateGoalisPresentRelatedUI(),r.$preview.find(".charitable-field-progress-bar .campaign-goal").each(function(){var a=t(this).find("span").html();parseFloat(e).toFixed(2);wpchar.debug(charitable_builder.currency_symbol+e),t(this).html("<span>"+a+"</span> "+charitable_builder.currency_symbol+e)})):/^\d+\.\d+$/.test(e)?(wpchar.debug("updateGoalRelatedItems - checkpoint 2"),c.updateGoalisPresentRelatedUI(),r.$preview.find(".charitable-field-progress-bar .campaign-goal").each(function(){var a=t(this).find("span").html(),i=parseFloat(e).toFixed(2);i=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),t(this).html("<span>"+a+"</span> "+charitable_builder.currency_symbol+i)})):(wpchar.debug("updateGoalRelatedItems - checkpoint 3"),c.updateGoalisPresentRelatedUI(),e=e.replace(/[^0-9\.\,]/g,""),r.$preview.find(".charitable-field-progress-bar .campaign-goal").each(function(){var a=t(this).find("span").html();t(this).html("<span>"+a+"</span> "+charitable_builder.currency_symbol+e)}))}},updateGoalisPresentRelatedUI:function(){r.$preview.find(".charitable-field-campaign-summary").each(function(){var e=t(this).attr("data-field-id"),a=t(this);t('input[name="_fields['+e+"][show_hide][campaign_hide_percent_raised]").is(":checked")&&(t(this).hasClass("charitable-hidden")||a.find(".campaign-raised.campaign-summary-item").removeClass("charitable-hidden")),r.$fieldOptions.find('input[name="_fields['+e+"][show_hide][campaign_hide_percent_raised]").attr("disabled",!1).removeClass("charitable-disabled").next().removeClass("charitable-disabled")}),r.$preview.find(".charitable-field-progress-bar .progress").removeClass("charitable-campaign-preview-not-available").removeClass("charitable-hidden")},highlightEvents:function(e){e.on("click","a.charitable-addon-installed-charitable-lite, a.charitable-addon-installed-charitable-pro",function(e){e.preventDefault(),t(this).hasClass("charitable-addon-recurring-donations")&&(r.$settingsPanel.find(".charitable-panel-fields-group-recurring-donations").removeClass("charitable-highlight"),t("a.charitable-panel-sidebar-section-donation-options").click(),r.$settingsPanel.find(".charitable-panel-fields-group-recurring-donations").addClass("charitable-highlight"))}),e.on("webkitAnimationEnd oanimationend msAnimationEnd animationend",".charitable-panel-fields-group-recurring-donations",function(e){r.$settingsPanel.find(".charitable-panel-fields-group-recurring-donations").removeClass("charitable-highlight")})},advancedLayoutOptionsEvents:function(e){e.on("change","select#charitable-design-layout-options-show-field-names",function(e){const a=t(this);"hide"===a.val()?r.$formPreview.addClass("charitable-preview-hide-field-names"):"show"===a.val()&&r.$formPreview.removeClass("charitable-preview-hide-field-names")}),e.on("change","select#charitable-design-layout-options-preview-mode",function(e){const a=t(this);"normal"===a.val()?r.$formPreview.removeClass("charitable-preview-minimum-preview"):"minimum"===a.val()&&r.$formPreview.addClass("charitable-preview-minimum-preview")})},previewHover:function(e){e.on("mouseover",".charitable-view-campaign-external-link",function(e){r.$formPreview.addClass("charitable-preview-live")}),e.on("mouseleave",".charitable-view-campaign-external-link",function(e){r.$formPreview.removeClass("charitable-preview-live")})},donateButtonEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="text"].charitable-campaign-builder-donate-button-button-label',function(e){const a=t(this),i=a.closest(".charitable-panel-field").data("field-id");c.updateDonateButtonPreview(i,a.attr("name"),a.val())})},updateDonateButtonPreview:function(e=0,a="",i="Donate"){const l=t("#charitable-field-"+e);i=i.length>0?CharitableUtils.santitizeTextInput(i):"Donate",l.find(".placeholder").html(i)},donateWallEvents:function(e){e.on("input",".charitable-panel-field.charitable-campaign-builder-donor-wall input, .charitable-panel-field.charitable-campaign-builder-donor-wall select",function(e){const a=t(this),i=a.closest(".charitable-panel-field").data("field-id");c.updateDonateWallPreview(i,a)})},updateDonateWallPreview:function(e=0,a){var l={};return t('.charitable-panel-field.charitable-campaign-builder-donor-wall[data-field-id="'+e+'"]').each(function(){var a=t(this);a.find('input.charitable-checkbox-for-toggle[type="checkbox"]:checked').each(function(){var a=t(this).closest('.charitable-toggle-control[data-field-id="'+e+'"]').data("ajax-label");t(this).is(":checked")?l[a]=t(this).val():l[a]=0}),a.find('input[type="radio"]:checked,input[type="text"],input[type="number"],select').each(function(){var a=t(this).closest('.charitable-panel-field[data-field-id="'+e+'"]').data("ajax-label");l[a]=t(this).val()}),l.campaign_id=i.formID,l.field_type="donation-wall",l.field_id=e,l.action="charitable_builder_field_content_preview",l.nonce=charitable_builder.nonce}),c.disableFormActions(),t('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+e+'"]').addClass("charitable-loading"),t("#charitable-field-"+e+" .charitable-preview-field-container span.placeholder").addClass("charitable-loading").parent().prepend('<div class="charitable-loading-spinner preview-ajax"></div>'),t.post(charitable_builder.ajax_url,l,function(a){if(a.success){t("#charitable-field-"+e+" .charitable-preview-field-container").replaceWith(a.data.output);var i=t('.charitable-panel-field-text[data-field-id="'+e+'"] input[type="text"].charitable-campaign-builder-headline');c.updateHeadlinePreview(e,i.attr("name"),i.val(),i),c.enableFormActions(),t('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+e+'"]').removeClass("charitable-loading"),t("#charitable-field-"+e+" .charitable-preview-field-container span.placeholder").removeClass("charitable-loading").parent().remove(".charitable-loading")}else wpchar.debug("Add field AJAX call is unsuccessful:",a)}).fail(function(a,i,l){wpchar.debug("Add field AJAX call failed:",a.responseText),t('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+e+'"]').removeClass("charitable-loading"),t("#charitable-field-"+e+" .charitable-preview-field-container span.placeholder").removeClass("charitable-loading").parent().remove(".charitable-loading")}).always(function(){})},progressBarEvents:function(e){e.on("change",".charitable-panel-field.charitable-campaign-builder-progress-bar input, .charitable-panel-field.charitable-campaign-builder-progress-bar select",function(e){var a=t(this),i=a.attr("data-field-id");c.progressBarEventsPreview(i,a)}),e.on("keyup",".charitable-panel-field.charitable-panel-field-text input.donate_label, .charitable-panel-field.charitable-panel-field-text input.donate_goal",function(e){var a=t(this),i=a.attr("data-field-id");c.progressBarEventsPreviewLabels(i,a)})},progressBarEventsPreviewLabels:function(e=0,a=""){const i=t("#charitable-field-"+e);a.hasClass("donate_label")&&i.find(".campaign-percent-raised span").html(a.val()),a.hasClass("donate_goal")&&i.find(".campaign-goal span").html(a.val())},progressBarEventsPreview:function(e=0,a=""){const i=t("#charitable-field-"+e);"show_donated"===a.val()&&i.find(".campaign-percent-raised").toggleClass("charitable-hidden"),"show_goal"===a.val()&&i.find(".campaign-goal").toggleClass("charitable-hidden")},cssTextFieldEvents:function(e){e.on("input",'.charitable-panel-field-text input[data-ajax-label="css_class"]',function(e){const a=t(this),i=CharitableUtils.santitizeCSSInput(a.val());t(this).val(i),c.setCampaignNotSaved()})},textFieldEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="text"][data-ajax-label!="css_class"]:not(.charitable-campaign-builder-headline, .charitable-campaign-builder-donate-button-button-label)',function(e){const a=t(this),i=CharitableUtils.santitizeTextInput(a.val());t(this).val(i),c.setCampaignNotSaved()})},headlineEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="text"].charitable-campaign-builder-headline',function(e){const a=t(this),i=a.closest(".charitable-panel-field").data("field-id");c.updateHeadlinePreview(i,a.attr("name"),a.val(),a),c.setCampaignNotSaved()})},updateHeadlinePreview:function(e=0,a="",i="",l){const n=t("#charitable-field-"+e),r=CharitableUtils.santitizeTitle(i),o=i.length>0?'<h5 class="charitable-field-preview-headline">'+r+"</h5>":"",d=n.find(".charitable-placeholder").length>0?".charitable-placeholder":".placeholder",c=n.find(".charitable-field-preview-social-sharing-headline-container").length>0?".charitable-field-preview-social-sharing-headline-container":d;l.val(r),n.find(c).find("h5.charitable-field-preview-headline").remove(),n.find(c).first().prepend(o)},shortcodeEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="text"].charitable-campaign-builder-shortcode',function(e){const a=t(this),i=a.closest(".charitable-panel-field").data("field-id");c.updateShortcodePreview(i,a.attr("name"),a.val())})},updateShortcodePreview:function(e=0,a="",i=""){const l=t("#charitable-field-"+e),n=i.length>0?'<h5 class="charitable-field-preview-shortcode">'+i+"</h5>":"";l.find(".placeholder.shortcode-preview").find("h5.charitable-field-preview-shortcode").remove(),l.find(".placeholder.shortcode-preview").first().prepend(n)},organizerEvents:function(e){e.on("change",".charitable-panel-field.campaign-builder-campaign-creator-id-mini select",function(e){var a=t(this),i=t(this).find("option:selected").data("avatar"),l=a.closest(".charitable-panel-field").attr("data-field-id");c.organizerEventsPreview(l,a,i)})},organizerEventsPreview:function(e=0,a="",i=""){t("select#charitable-panel-field-settings-campaign_campaign_creator_id").select2("val",a.val());const l=t("#charitable-field-"+e);l.find(".charitable-organizer-name").html(a.find("option:selected").text()),l.find(".charitable-organizer-image").attr("style","background-image: url("+i+");")},campaignSummaryEvents:function(e){e.on("click",'.charitable-campaign-summary-checkboxes input[type="checkbox"]',function(e){const a=t(this),i=a.closest(".charitable-panel-field").data("field-id");c.updateCampaignSummaryPreview(i,a.attr("name"))})},updateCampaignSummaryPreview:function(e=0,a=""){const i=t("#charitable-field-"+e);a.indexOf("campaign_hide_percent_raised")>=0&&i.find(".campaign_hide_percent_raised").toggleClass("charitable-hidden"),a.indexOf("campaign_hide_amount_donated")>=0&&i.find(".campaign_hide_amount_donated").toggleClass("charitable-hidden"),a.indexOf("campaign_hide_number_of_donors")>=0&&i.find(".campaign_hide_number_of_donors").toggleClass("charitable-hidden"),a.indexOf("campaign_hide_time_remaining")>=0&&i.find(".campaign_hide_time_remaining").toggleClass("charitable-hidden")},socialSharingEvents:function(e){e.on("click",'.charitable-social-network-checkboxes input[type="checkbox"]',function(e){const a=t(this),i=a.closest(".charitable-panel-field").data("field-id");c.updateSocialSharingPreview(i,a.attr("name"))})},updateSocialSharingPreview:function(e=0,a=""){const i=t("#charitable-field-"+e);a.indexOf("twitter")>=0&&i.find(".charitable-social-sharing-preview-twitter").toggleClass("charitable-hidden"),a.indexOf("facebook")>=0&&i.find(".charitable-social-sharing-preview-facebook").toggleClass("charitable-hidden"),a.indexOf("linkedin")>=0&&i.find(".charitable-social-sharing-preview-linkedin").toggleClass("charitable-hidden"),a.indexOf("instagram")>=0&&i.find(".charitable-social-sharing-preview-instagram").toggleClass("charitable-hidden"),a.indexOf("tiktok")>=0&&i.find(".charitable-social-sharing-preview-tiktok").toggleClass("charitable-hidden"),a.indexOf("pinterest")>=0&&i.find(".charitable-social-sharing-preview-pinterest").toggleClass("charitable-hidden"),a.indexOf("mastodon")>=0&&i.find(".charitable-social-sharing-preview-mastodon").toggleClass("charitable-hidden"),a.indexOf("threads")>=0&&i.find(".charitable-social-sharing-preview-threads").toggleClass("charitable-hidden"),a.indexOf("bluesky")>=0&&i.find(".charitable-social-sharing-preview-bluesky").toggleClass("charitable-hidden")},socialLinkingEvents:function(e){e.on("input",'.charitable-panel-field-text input[type="url"].charitable-campaign-builder-social-links-text-field',function(e){var a=t(this),i=a.attr("data-field-id");c.updateSocialLinksPreview(i,a.attr("name"),a.val())})},updateSocialLinksPreview:function(e=0,a="",i=""){const l=t("#charitable-field-"+e);var n=0;t.each(["twitter","facebook","linkedin","instagram","tiktok","pinterest","mastodon","youtube","threads","bluesky"],function(e,t){a.indexOf(t)>=0&&c.isValidURL(i)?l.find(".charitable-social-linking-preview-"+t).removeClass("charitable-hidden"):a.indexOf(t)>=0&&l.find(".charitable-social-linking-preview-"+t).addClass("charitable-hidden"),l.find(".charitable-social-linking-preview-"+t).hasClass("charitable-hidden")||n++}),n>0?l.find(".charitable-social-linking-no-links").addClass("charitable-hidden"):l.find(".charitable-social-linking-no-links").removeClass("charitable-hidden")},photoFieldEvents:function(e){var i;a.formfield="",e.on("click",".charitable-campaign-builder-upload-button",function(e){e.preventDefault();var l=t(this),n=t(this).closest(".charitable-panel-field").data("field-id");a.formfield=t(this).parent().prev(),a.field_id=n,i||((i=wp.media.frames.file_frame=wp.media({title:l.data("uploader_title"),library:{type:"image"},button:{text:l.data("uploader_button_text")},multiple:!1})).on("menu:render:default",function(e){e.unset("library-separator"),e.unset("gallery"),e.unset("featured-image"),e.unset("embed"),e.set({})}),i.on("select",function(){i.state().get("selection").each(function(e,t){e=e.toJSON(),a.formfield.val(e.url),c.updateImagePhotoPreview(a.field_id,e.url),a.field_id=!1})})),i.open()}),e.on("click",".charitable-campaign-builder-clear-button",function(e){e.preventDefault();const a=t(this),i=t(this).closest(".charitable-panel-field").data("field-id");a.closest(".charitable-internal").find('input[type="url"]').val(""),c.updateImagePhotoPreview(i,!1)})},updateImagePhotoPreview:function(e=0,a=""){const i=t("#charitable-field-"+e),l=i.find("img.charitable-campaign-builder-preview-photo");!1!==a&&""!==a&&c.isValidURL(a)?(i.find("i.temp-icon").remove(),l.length>0?l.attr("src",a):(i.find(".primary-image-container .primary-image").append('<img src="'+a+'" class="charitable-campaign-builder-preview-photo" />'),i.find(".primary-image-container").addClass("has-image"))):(i.find(".primary-image-container .primary-image img").remove(),i.find(".primary-image-container .primary-image").append('<img src="../../images/campaign-builder/fields/photo/temp-icon.svg" class="temp-icon" alt="" />'),i.find(".primary-image-container").removeClass("has-image"))},isValidURL:function(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)},resetPreviewArea:function(){r.$formPreview.find(".charitable-field").each(function(){t(this).removeClass("active")}),t(".charitable-select-field-notice").show(),t(".charitable-layout-options-tab-general .charitable-panel-field").removeClass("active"),t("#charitable-preview-tab-container").removeClass("active")},fieldDelete:function(e,a=!0){var i=t("#charitable-field-"+e),l=i.data("field-type");i.hasClass("no-delete")?c.youCantRemoveFieldPopup():a?c.confirmFieldDeletion(e,l):c.fieldDeleteById(e,l)},confirmFieldDeletion:function(e,a){var i={id:e,message:charitable_builder.delete_confirm};CharitableUtils.triggerEvent(l,"charitableBeforeFieldDeleteAlert",[i,a]).isDefaultPrevented()||t.confirm({title:!1,content:i.message,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){c.fieldDeleteById(e,a)}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})},confirmCampaignDeletion:function(){l.on("click",".charitable-button.alert.delete-campaign",function(e){e.preventDefault(),t.alert({title:!1,content:charitable_builder.campaign_delete_confirm,icon:"fa fa-info-circle",type:"red",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})})},fieldDeleteById:function(e=!1,a="",i=200){!1!==e&&t(`#charitable-field-${e}`).fadeOut(i,function(){const a=t(this),i=a.closest(".charitable-field-section"),n=a.data("field-type"),o=void 0!==a.data("field-max")?parseInt(a.data("field-max")):99;l.trigger("charitableBeforeFieldDelete",[e,n]),a.remove(),t("#charitable-field-option-"+e).remove(),t(".charitable-field, .charitable-preview-top-bar").removeClass("active"),t('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+e+'"]').remove(),t(".charitable-select-field-notice").show(),c.checkNoFieldsPreview(),c.checkFieldTargetState(i),(0===o||r.$preview.find(".charitable-field.charitable-field-donate-amount").length<o)&&t("#charitable-panel-design button#charitable-add-fields-donate-amount").removeClass("charitable-disabled"),c.checkIfTabsAreEmpty(),t(".charitable-layout-options-tab.charitable-layout-options-tab-general").hasClass("active")&&c.fieldTabToggle("add-layout");const d=t(".charitable-field-option"),s=l.find(".charitable-field-submit");d.length<1&&(r.$sortableFieldsWrap.append(r.$noFieldsPreview.clone()),r.$fieldOptions.append(r.$noFieldsOptions.clone()),s.hide()),d.filter(":not(.charitable-field-option-layout)").length||s.hide(),c.checkFieldAllow(),c.checkFieldMax(n,o),c.checkRecommendedFields(n),wpCookies.get("charitable_panel_active_field_id")===e&&wpCookies.set("charitable_panel_active_field_id","",2592e3),c.setCampaignNotSaved(),l.trigger("charitableFieldDelete",[e,n])})},fieldEdit:function(e,a,i,n,r){"general"!==a&&"standard"!==a&&"pro"!==a&&"recommended"!==a||(c.panelSwitch("design"),t(".charitable-select-field-notice").hide(),t(".charitable-layout-options-tab-general .charitable-panel-field").removeClass("active"),t('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+n+'"]').addClass("active"),t('.charitable-layout-options-tab-general .charitable-panel-field[data-field-id="'+n+'"]').find("input[type=text],input[type=button],input[type=range],input[type=url],textarea,select").filter(":visible:first").focus(),"html"===r?l.trigger("charitableFieldAddHTML",[n,r]):l.trigger("charitableFieldEdit",[e,a,i,n,r]))},fieldDuplicate:function(e){const a=t(`#charitable-field-${e}`);a.hasClass("no-duplicate")?t.alert({title:charitable_builder.field_locked,content:charitable_builder.field_locked_no_duplicate_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:charitable_builder.close,btnClass:"btn-confirm",keys:["enter"]}}}):t.confirm({title:!1,content:charitable_builder.duplicate_confirm,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){this.$$confirm.prop("disabled",!0);if(CharitableUtils.triggerEvent(l,"charitableBeforeFieldDuplicate",[e,a]).isDefaultPrevented())return;const i=c.fieldDuplicateRoutine(e),n=t(`#charitable-field-${i}`);CharitableUtils.triggerEvent(l,"charitableFieldDuplicated",[e,a,i,n])}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})},fieldDuplicateRoutine:function(e){const a=t(`#charitable-field-${e}`),i=r.$sortableFieldsWrap.find("> .active"),l=r.$sortableFieldsWrap.find("> .active"),n=a.clone(),o=parseInt(r.$nextFieldId.val(),10)+1,d=t('#charitable-field-options .charitable-layout-options-group-inner .charitable-panel-field[data-field-id="'+e+'"]');return n&&c.updateFormHiddenFieldID(o),a.after(n),i.removeClass("active"),l.removeClass("active"),n.addClass("active").attr({id:`charitable-field-${o}`,"data-field-id":o}),d.each(function(){var a=t(this).clone(),i=a.text().indexOf("ID:")>-1;if(a.attr("data-field-id",o),t(this).removeClass("active"),a.addClass("active"),i&&a.text(function(a,t){return t.replace("ID: "+e,"ID: "+o)}),void 0!==a.attr("name")&&a.attr("name").length>0&&a.attr("name",a.attr("name").replace(e,o)),void 0!==a.attr("id")&&a.attr("id").length>0&&a.attr("id",a.attr("id").replace(e,o)),a.find("*").each(function(){var i=t(this);void 0!==i.attr("for")&&i.attr("for").length>0&&i.attr("for",i.attr("for").replace(e,o)),void 0!==i.attr("name")&&i.attr("name").length>0&&i.attr("name",i.attr("name").replace(e,o)),void 0!==i.attr("id")&&i.attr("id").length>0&&i.attr("id",i.attr("id").replace(e,o)),void 0!==i.data("field-id")&&i.data("field-id").length>0&&a.attr("data-field-id",o)}),a.find(".charitable-toggle-control").attr("data-field-id",o),a.find(".charitable-checkbox-for-toggle").attr("data-field-id",o),t("#charitable-field-options .charitable-layout-options-tab-general .charitable-layout-options-group-inner").append(a),void 0!==a.data("special-type")&&"campaign_description"===a.data("special-type")){let e=a.find(".campaign-builder-htmleditor .ql-editor").html();a.find(".ql-toolbar").remove(),a.find(".campaign-builder-htmleditor").html('<div data-textarea-name="_fields['+o+'][content]" id="charitable-panel-field-settings-field_campaign-description_html_'+o+'" class="campaign-builder-htmleditor">'+e+"</div>"),c.initHTMLEditorFields(a.find(".campaign-builder-htmleditor"),!1)}c.checkFieldAllow(),c.checkFieldMax()}),o},focusOutEvent:function(){null!==r.$focusOutTarget&&(r.$focusOutTarget=null)},isFormPreviewActionsDisabled:function(e){return t(e).closest(".charitable-field-wrap").hasClass("ui-sortable-disabled")},fieldGroupTogglev2:function(e,a){var i=t(e),l=i.closest(".charitable-group").data("group_id"),n=i.closest(".charitable-group"),r=n.find(".charitable-group-rows"),o=(r.parent(),i.find("i")),d="charitable_panel_layout_options_tabs_tab_open_"+l;if("click"===a)return o.toggleClass("charitable-angle-right"),void r.stop().slideToggle("",function(){n.toggleClass("charitable-closed"),n.hasClass("charitable-closed")?(n.removeClass("charitable-open"),wpCookies.remove(d)):wpCookies.set(d,"true",2592e3)})},fieldGroupTogglev3:function(e,a="click"){var i=t(e),l=i.closest(".charitable-add-fields-group"),n=l.find(".charitable-group-rows"),r="charitable_panel_add_layout_blocks_open_test";if("click"===a)return i.toggleClass("charitable-angle-right"),void n.stop().slideToggle("",function(){l.toggleClass("charitable-closed"),l.hasClass("charitable-closed")?(l.removeClass("charitable-open"),wpCookies.remove(r)):wpCookies.set(r,"true",2592e3)})},fieldGroupToggle:function(e,a){var i=t(e),l=i.next(".charitable-add-fields-buttons"),n=l.parent(),r=i.find("i"),o=i.data("group"),d="charitable_field_group_"+o;if("general-layout-campaign"!=o&&"general-layout-faq"!=o||(l=n=i.parent().find(".charitable-"+o+"-group-inner")),"click"===a)return n.hasClass("charitable-closed")?wpCookies.remove(d):wpCookies.set(d,"true",2592e3),r.toggleClass("charitable-angle-right"),void l.stop().slideToggle("",function(){n.toggleClass("charitable-closed")});"load"===a&&(l=i.find(".charitable-add-fields-buttons"),r=i.find(".charitable-add-fields-heading i"),d="charitable_field_group_"+(o=i.find(".charitable-add-fields-heading").data("group")),"true"===wpCookies.get(d)&&(r.toggleClass("charitable-angle-right"),l.hide(),i.toggleClass("charitable-closed")))},fieldMove:function(e,a){var t=a.field;t.find(".charitable-field-edit").click(),l.find(".charitable-add-fields .charitable-add-fields-button").prop("disabled",!1);var i=t.closest(".charitable-field-section");c.checkFieldTargetState(i),a.section&&c.checkFieldTargetState(a.section),l.trigger("charitableFieldMove",[a.fieldId,e])},fieldAdd:function(e,a){t(`#charitable-add-fields-${e}`);d=!0,Charitable.Admin.Builder.DragFields&&"function"==typeof Charitable.Admin.Builder.DragFields.disableDragAndDrop&&Charitable.Admin.Builder.DragFields.disableDragAndDrop(),c.disableFormActions();let n={campaign_title:i.campaignTitle,position:"bottom",$sortable:"base",placeholder:!1,scroll:!0,defaults:!1,column_id:a.column_id,tab_id:a.tab_id,section_id:a.section_id,area:"fields"};a=t.extend({},n,a);let o={action:"charitable_new_field_"+e,id:i.formID,column_id:a.column_id,tab_id:a.tab_id,section_id:a.section_id,field_id:parseInt(r.$nextFieldId.val())+1,type:e,campaign_title:a.campaign_title,defaults:a.defaults,nonce:charitable_builder.nonce};return t.post(charitable_builder.ajax_url,o,function(n){if(!n.success)return void wpchar.debug("Add field AJAX call is unsuccessful:",n);wpchar.debug("fieldAdd return"),c.refreshTabFieldsSortDrag();let s="tabs"===a.area?r.$sortableTabContent.find('li[data-tab-id="'+o.tab_id+'"] .charitable-tab-wrap'):r.$formPreview.find('.charitable-field-wrap[data-section-id="'+o.section_id+'"]');wpchar.debug(s);const p=t(n.data.preview),h=void 0!==n.data.max?parseInt(n.data.max):99,b=t(n.data.options);let u=a.$sortable;d=!1,p.css("display","none"),a.placeholder&&a.placeholder.remove(),"default"!==a.$sortable&&a.$sortable.length||(u=s.find(".charitable-fields-sortable-default")),"base"!==a.$sortable&&u.length||(u=s);let m=CharitableUtils.triggerEvent(l,"charitableBeforeFieldAddToDOM",[a,p,b,u]);if(!m.isDefaultPrevented()){m.skipAddFieldToBaseLevel||c.fieldAddToBaseLevel(a,p,b),r.$preview.find(".charitable-field.charitable-field-donate-amount").length>=h&&t("#charitable-panel-design button#charitable-add-fields-donate-amount").addClass("charitable-disabled"),p.fadeIn(),c.checkFieldTargetState(t('.charitable-field-section[data-section-id="'+o.section_id+'"]')),p.find(".charitable-field-edit").click(),t(".charitable-field-option:not(.charitable-field-option-layout)").length&&l.find(".charitable-field-submit").show(),c.updateFormHiddenFieldID(n.data.field_id),""!==n.data.edit_field_html&&(t(".charitable-layout-options-tab-general .charitable-layout-options-group-inner").append(n.data.edit_field_html).find('.charitable-panel-field[data-field-id="'+n.data.field_id+'"]').addClass("active"),""!=n.data.html_field&&t('.charitable-panel-field[data-field-id="'+n.data.field_id+'"]').find(".campaign-builder-htmleditor").each(function(){c.initHTMLEditorFields(t(this),!1)}),"campaign-description"===e&&void 0!==i.campaignDescription&&(p.find(".charitable-campaign-builder-no-description-preview").html("<div>"+i.campaignDescription+"</div>"),0===t("#charitable-panel-field-settings-field_campaign-description_html_"+o.field_id).find(".ql-editor").length&&c.initHTMLEditorFields(t("#charitable-panel-field-settings-field_campaign-description_html_"+o.field_id)),t("#charitable-panel-field-settings-field_campaign-description_html_"+o.field_id).find(".ql-editor").html(i.campaignDescription))),"organizer"===n.data.field.type&&t('.campaign-builder-campaign-creator-id-mini[data-field-id="'+n.data.field_id+'"] select').select2({templateResult:c.campaignCreatorFormatOptions}),c.checkFieldAllow(),c.checkFieldMax(),c.updateEndDateRelatedItems(),c.updateGoalRelatedItems(),c.checkRecommendedFields(e);var f=u.data("section-type");void 0!==f&&"fields"===f&&!0,c.checkNoFieldsPreview(),"photo"===e?t('.charitable-panel-field-uploader[data-field-id="'+n.data.field_id+'"] input.charitable-campaign-builder-upload-button').click():"donate-amount"===e&&t(".charitable-campaign-suggested-donations-mini").each(function(){c.initSuggestedDonationsMini(t(this)),c.updateSuggestdDonationsMiniRowsFromSettings(t(this))}),l.trigger("charitableFieldAdd",[n.data.field.id,e])}}).fail(function(e,a,t){d=!1}).always(function(){l.find(".charitable-add-fields .charitable-add-fields-button").prop("disabled",!1),d||(Charitable.Admin.Builder.DragFields&&"function"==typeof Charitable.Admin.Builder.DragFields.enableDragAndDrop&&Charitable.Admin.Builder.DragFields.enableDragAndDrop(),c.enableFormActions())})},fieldAddToBaseLevel:function(e,a,t){wpchar.debug("options"),wpchar.debug(e);let i="";"tabs"===e.area?(i=r.$sortableTabContent.find('li[data-tab-id="'+e.tab_id+'"] .charitable-tab-wrap'),i.parent().removeClass("empty-tab")):i=r.$formPreview.find('.charitable-field-wrap[data-section-id="'+e.section_id+'"]'),wpchar.debug("baseFieldsContainer"),wpchar.debug(i);const l=i.find("> :not(.charitable-field-drag-pending)"),n=l.last(),o=l.length;let d=r.$fieldOptions;if("top"!==e.position){if(!("bottom"!==e.position||n.length&&n.hasClass("charitable-field-stick")))return wpchar.debug("adding field to the bottom!!!!"),void i.append(a);"bottom"===e.position&&(e.position=o),e.position===o&&n.length&&n.hasClass("charitable-field-stick")?n.before(a):(d=i.children(":not(.charitable-field-drag-pending)").eq(e.position),d.length?d.before(a):i.append(a))}else i.prepend(a)},checkIfTabsAreEmpty:function(){r.$preview.find(".tab-content ul li.tab_content_item").each(function(){0===t(this).find(".charitable-field").length&&t(this).addClass("empty-tab")})},disableFormActions:function(e=!1,a=!0,i=!1){t.each([r.$embedButton,r.$statusButton,r.$saveButton],function(e,a){a.prop("disabled",!0).addClass("charitable-disabled")}),e&&t.each([r.$exitButton],function(e,a){a.prop("disabled",!0).addClass("charitable-disabled")}),a&&(t(".charitable-edit-campaign-title-area").addClass("charitable-disabled"),t(".charitable-edit-campaign-title-area input").prop("disabled",!0),t(".charitable-edit-campaign-title-area a").addClass("charitable-disabled")),i&&r.$previewButton.prop("disabled",!0).addClass("charitable-disabled")},enableFormActions:function(){t.each([r.$statusButton,r.$saveButton,r.$exitButton],function(e,a){a.prop("disabled",!1).removeClass("charitable-disabled")}),t(".charitable-edit-campaign-title-area").removeClass("charitable-disabled"),t(".charitable-edit-campaign-title-area input").prop("disabled",!1),t(".charitable-edit-campaign-title-area a").removeClass("charitable-disabled"),"publish"===i.formStatus&&r.$embedButton.prop("disabled",!1).removeClass("charitable-disabled")},fieldChoiceDeleteAlert:function(){t.alert({title:!1,content:charitable_builder.error_choice,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},fieldChoiceSortable:function(e,a){t(a=void 0!==a?a:".charitable-field-option-"+e+" .charitable-field-option-row-choices ul").sortable({items:"li",axis:"y",delay:100,opacity:.6,handle:".move",stop:function(a,t){var i=t.item.parent().data("field-id");c.fieldChoiceUpdate(e,i),l.trigger("charitableFieldChoiceMove",t)},update:function(e,a){}})},tabDelete:function(e){c.confirmTabDeletion(e)},confirmTabDeletion:function(e){var a={id:e,message:charitable_builder.delete_tab_confirm};CharitableUtils.triggerEvent(l,"charitableBeforeTabDeleteAlert",[a]).isDefaultPrevented()||t.confirm({title:!1,content:charitable_builder.delete_tab_confirm,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){c.tabDeleteById(e)}},cancel:{text:charitable_builder.cancel,keys:["esc"]}}})},tabDeleteById:function(e){const a=r.$fieldOptions.find('[data-group_id="'+e+'"]'),i=t("nav ul li#tab_"+e+"_title"),l=r.$preview.find('.tab-content ul li.tab_content_item[data-tab-id="'+e+'"]'),n=r.$preview.find(".tab-content .tab_content_item").length-1,o=Math.abs(e-1),d=r.$preview.find(".tab-content");a.remove(),i.remove(),l.remove(),r.$preview.find('nav.charitable-campaign-preview-nav ul li[data-tab-id="'+o+'"] a').length>0?r.$preview.find('nav.charitable-campaign-preview-nav ul li[data-tab-id="'+o+'"] a').click():1===n&&r.$preview.find("nav.charitable-campaign-preview-nav ul li a").first().click(),0===n?(d.addClass("empty-tabs"),d.append('<p class="no-tab-notice">'+charitable_builder.no_tabs+"</p>")):(d.removeClass("empty-tabs"),d.find(".no-tab-notice").remove()),c.checkHideTabNavigation()},bindUIActionsPreview:function(){t("body").on("click","a#charitable-preview-btn",function(e){if(e.preventDefault(),e.stopPropagation(),0!==parseInt(r.$campaignID.val())){var a="";void 0!==this.href&&(a=this.href.replace("charitable_campaign_preview=0","charitable_campaign_preview="+i.campaignID)),(void 0!==i.formStatus&&"publish"===i.formStatus||void 0!==i.formStatus&&"draft"===i.formStatus)&&c.formSave(!1,!0,a)}else t.alert({title:charitable_builder.no_preview_must_save,content:charitable_builder.no_preview_must_save_msg,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:charitable_builder.close,btnClass:"btn-confirm",keys:["enter"]}}})})},bindUIActionsSaveExit:function(){l.on("click","#charitable-embed",function(e){e.preventDefault(),e.stopPropagation(),t(this).hasClass("charitable-disabled")||CharitableCampaignEmbedWizard.openPopup(i.formID)}),l.on("click","#charitable-status-button",function(e){e.preventDefault(),e.stopPropagation(),t(this).hasClass("charitable-disabled")||(t(this).hasClass("active")?(t(this).parent().find("ul#charitable-status-dropdown").addClass("charitable-hidden"),t(this).removeClass("active")):(t(this).parent().find("ul#charitable-status-dropdown").removeClass("charitable-hidden"),t(this).addClass("active")))}),l.on("click","ul#charitable-status-dropdown a",function(e){if(e.preventDefault(),e.stopPropagation(),!t("#charitable-status-button").hasClass("charitable-disabled")){var a=t(this).data("status"),l=t(this).data("status-label"),n=t("ul#charitable-status-dropdown");n.addClass("charitable-hidden"),t("#charitable-status-button").removeClass("active"),t("#charitable-status-button span.text").html(l),t("#charitable-status-button").attr("data-status",a),n.find("a").removeClass("charitable-hidden"),n.find("a.switch-"+a).addClass("charitable-hidden"),n.find("a."+a).addClass("charitable-hidden"),i.formStatus=a,i.formStatusLabel=l}}),l.on("click",function(e){!1===t(e.target).is("#charitable-status-dropdown")&&(t("ul#charitable-status-dropdown").addClass("charitable-hidden"),t("#charitable-status-button").removeClass("active"))}),l.on("click","#charitable-save",function(e){e.preventDefault(),c.formSave(!1)}),l.on("click","#charitable-exit",function(e){e.preventDefault(),c.formExit()}),l.on("charitableSaved",function(e,a){t("#charitable_settings_title").attr("disabled",!0),wpchar.removeQueryParam("newform")})},updateFormID:function(){var e={action:"charitable_get_campaign_form_id",id:i.formID,nonce:charitable_builder.nonce};return t.post(charitable_builder.ajax_url,e,function(e){if(e.success){var a=e.data.campaign_id;t("form#charitable-builder-form").attr("data-id",a),t('form#charitable-builder-form input[name="id"]').val(a),e.data.field_id&&r.$nextFieldId.val(parseInt(e.data.field_id)),wpchar.savedState=wpchar.getFormState("#charitable-builder-form"),wpchar.initialSave=!1,l.trigger("charitableSaved",e.data),c.updateDebugWindow(e.data,e.data.campaign_id)}else c.formSaveError(e.data)}).fail(function(e,a,t){c.formSaveError()}).always(function(){})},updateFormHiddenFields:function(){t('#charitable-panel-design .charitable-panel-content-wrap input[type="hidden"]').remove(),t(".charitable-field-wrap .charitable-field, .charitable-tab-wrap .charitable-field").each(function(){var e=t(this).closest(".row").data("row-type"),a=t(this).closest(".row").data("row-id"),i=t(this).closest(".row").data("row-css").length>0?t(this).closest(".row").data("row-css"):"no-css",l=t(this).closest(".column.charitable-field-column").data("column-id"),n=t(this).closest(".section.charitable-field-section").data("section-type"),o=t(this).closest(".section.charitable-field-section").data("section-id"),d=t(this).data("field-id"),c="tabs"===n&&t(this).closest("li.tab_content_item").data("tab-id");void 0!==a&&("tabs"===n?r.$formPreview.append('<input type="hidden" name="layout[row][row-type-'+e+"]["+a+"]["+i+"][column]["+l+"][section][section-type-"+n+"]["+o+"][tabs]["+c+"][fields]["+d+']" value="'+t(this).data("field-type")+'" />'):r.$formPreview.append('<input type="hidden" name="layout[row][row-type-'+e+"]["+a+"]["+i+"][column]["+l+"][section][section-type-"+n+"]["+o+"][fields]["+d+']" value="'+t(this).data("field-type")+'" />'))})},updateFormHiddenFieldID:function(e=0){if(0===e){var a=0;r.$formPreview.find(".charitable-field").each(function(){var e=parseFloat(t(this).attr("data-field-id"));a=e>a?e:a}),e=a}r.$nextFieldId.val(parseInt(e))},updatePreviewLink:function(e=""){r.$previewButton.attr("href",e)},updateSuggestDonationsSettings:function(e,a){e.is("input")&&"text"===c.getInputType(e)&&(t("table#campaign_donation_amounts tbody").find('input[type="text"].campaign_suggested_donations').eq(a).val(e.val()),t(".charitable-campaign-suggested-donations-mini tbody").find('input[type="text"].campaign_suggested_donations').eq(a).val(e.val()),r.$preview.find(".charitable-field-donate-amount li.charitable-preview-donation-amount").eq(a/2-1).find("span").first().html(e.val()))},updateAllowCustomDonationSettings:function(e){const a=r.$preview.find(".charitable-preview-donation-options .custom-donation-amount");e?a.removeClass("charitable-hidden"):a.addClass("charitable-hidden")},updateSuggestedDonationAmountDefault:function(e=0){e>0?(t('input[type="radio"].campaign_suggested_donations').prop("checked",!1),t('input[type="radio"][value='+e+"].campaign_suggested_donations").prop("checked",!0),r.$preview.find(".charitable-field.charitable-field-donate-amount li").removeClass("selected"),r.$preview.find(".charitable-preview-donation-amounts li:nth-child("+e+")").addClass("selected"),r.$preview.find('.charitable-field.charitable-field-donate-amount input[type="radio"]').length>0&&r.$preview.find('.charitable-field.charitable-field-donate-amount input[type="radio"]:eq('+(e-1)+")").prop("checked",!0)):t("input:radio].campaign_suggested_donations").prop("checked",!1)},getInputType:function(e){var a=e;return"input"===a[0].tagName.toString().toLowerCase()?t(a[0]).prop("type").toLowerCase():a[0].tagName.toLowerCase()},updateCampaignCreatorInfo:function(){var e={action:"charitable_update_campaign_creator",creator_id:parseInt(t("select#charitable-panel-field-settings-campaign_campaign_creator_id").val()),campaign_id:i.formID,nonce:charitable_builder.nonce};return t.post(charitable_builder.ajax_url,e,function(e){e.success?(t("#campaign-creator .charitable-campaign-creator-avatar img").attr("src",e.data.avatar_url),t("#campaign-creator h3.creator-name").html(e.data.creator_name),t("#campaign-creator p.joined-on span").html(e.data.joined_on),t("#campaign-creator a.public-profile-link").attr("href",e.data.public_profile_link),t("#campaign-creator a.edit-profile-link").attr("href",e.data.edit_profile_link)):c.formSaveError(e.data)}).fail(function(e,a,t){c.formSaveError()}).always(function(){})},formSaveCheck:function(){if(0===t("#charitable_settings_title").val().length)return t.alert({title:charitable_builder.error_title,content:charitable_builder.error_no_title,icon:"fa fa-info-circle",type:"red",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}),!1},formSave:function(e,n=!1,o="",d=!1){var s=r.$saveButton,p=s.find("img.topbar_icon"),h=s.find("i.charitable-loading-spinner"),b=s.find("span"),u=i.formSavedStatus;if(!l.hasClass("charitable-is-revision")||l.hasClass("charitable-revision-is-saving")){if(!1!==c.formSaveCheck()&&("undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),!CharitableUtils.triggerEvent(l,"charitableBeforeSave").isDefaultPrevented())){t("#charitable_settings_title").removeAttr("disabled"),s.prop("disabled",!0),!1===n&&(b.text(charitable_builder.saving),p.addClass("charitable-hidden"),h.removeClass("charitable-hidden")),c.updateFormHiddenFields();var m={action:"charitable_save_campaign",data:JSON.stringify(t("#charitable-builder-form").serializeArray()),id:i.formID,status:i.formStatus,statusLabel:i.formStatusLabel,preview:n,nonce:charitable_builder.nonce};return t.post(charitable_builder.ajax_url,m,function(s){if(s.success){var p=parseInt(s.data.campaign_id);if(d)return a.location.href,c.addCampaignIDToURL(p),void(a.location.href=c.addCampaignIDToURL(p));if(t("form#charitable-builder-form").attr("data-id",p),t('form#charitable-builder-form input[name="id"]').val(p),i.formID=p,s.data.field_id&&r.$nextFieldId.val(parseInt(s.data.field_id)),wpchar.savedState=wpchar.getFormState("#charitable-builder-form"),wpchar.initialSave=!1,l.trigger("charitableSaved",s.data),c.updateDebugWindow(s.data,s.data.campaign_id),void 0!==s.data.preview_url&&s.data.preview_url.length>0&&c.updatePreviewLink(s.data.preview_url),!1===n&&c.setCampaignSaved(),!0===e&&(a.location.href=charitable_builder.exit_url),history.pushState){var h=c.addCampaignIDToURL(p);a.history.pushState({path:h},"",h)}else a.location.href=c.addCampaignIDToURL(p);i.campaignID=p,"draft"!==u&&""!==u||"publish"!==s.data.post_status||!s.data.permalink||CharitableCampaignCongratsWizard.openPopup(i.formID,s.data.permalink),"publish"===s.data.post_status?(r.$viewCampaignButton.removeClass("charitable-disabled"),r.$viewCampaignButton.attr("href",s.data.permalink),t("a.charitable-admin-campaign-link").attr("href",s.data.permalink),t("a.charitable-admin-campaign-link.show-url").html(s.data.permalink)):r.$viewCampaignButton.addClass("charitable-disabled"),"publish"===s.data.post_status?r.$embedButton.prop("disabled",!1).removeClass("charitable-disabled"):r.$embedButton.prop("disabled",!0).addClass("charitable-disabled"),i.formSavedStatus=s.data.post_status,i.formSavedStatusLabel=s.data.post_status_label,""!==o&&a.open(o);var b="[campaign id=&quot;"+p+"&quot;]";return t("#charitable-admin-campaign-embed-wizard-shortcode-wrap #charitable-admin-campaign-embed-wizard-shortcode").remove(),t("#charitable-admin-campaign-embed-wizard-shortcode-wrap").prepend('<input type="text" id="charitable-admin-campaign-embed-wizard-shortcode" class="charitable-admin-popup-shortcode" value="'+b+'" />'),t("#charitable-admin-campaign-embed-wizard-shortcode").prop("disabled",!0),c.setCampaignTitleSet(),c.addCampaignIDToURL(p)}c.formSaveError(s.data)}).fail(function(e,a,t){c.formSaveError()}).always(function(){b.text(charitable_builder.saved),setTimeout(function(){b.text(charitable_builder.save)},2500),s.prop("disabled",!1),h.addClass("charitable-hidden"),p.removeClass("charitable-hidden")})}}else c.confirmSaveRevision()},formSaveError:function(e){wpchar.empty(e)&&(e=charitable_builder.error_save_form),t.confirm({title:charitable_builder.heads_up,content:"<p>"+e+"</p><p>"+charitable_builder.error_contact_support+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},formGenericError:function(e){wpchar.empty(e)&&(e=charitable_builder.something_went_wrong),t.confirm({title:charitable_builder.heads_up,content:"<p>"+e+"</p><p>"+charitable_builder.error_contact_support+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},formGenericNotice:function(e){wpchar.empty(e)&&(e=charitable_builder.something_went_wrong),t.confirm({title:charitable_builder.heads_up,content:"<p>"+e+"</p>",icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},addCampaignIDToURL:function(e){const t=a.location.href;let i=!1;if(t.includes("?")){return a.location.search.includes("campaign_id")?(i=t.split("#")[0],i):(i=t.split("#")[0],i+"&campaign_id="+e)}return t+"?campaign_id="+e},fieldTabToggle:function(e){if(CharitableUtils.triggerEvent(l,"charitableFieldTabToggle",[e]).isDefaultPrevented())return!1;t(".charitable-tab a").removeClass("active"),t(".charitable-field, .charitable-preview-top-bar").removeClass("active"),"add-layout"===e?(t("#add-layout a").addClass("active"),t(".charitable-field-options").hide(),t(".charitable-add-fields").show()):"layout-options"===e?(t("#layout-options a").addClass("active"),t(".charitable-add-fields").hide(),t(".charitable-field-options").show()):(t("#charitable-field-"+e).addClass("active"),t(".charitable-field-option").hide(),t("#charitable-field-option-"+e).show(),t(".charitable-add-fields").hide(),t(".charitable-field-options").show(),l.trigger("charitableFieldOptionTabToggle",[e])),wpCookies.set("charitable_panel_content_section",e,2592e3),wpCookies.set("charitable_panel_active_field_id","",2592e3),wpCookies.set("charitable_panel_design_layout_options_group","",2592e3),wpCookies.set("charitable_panel_tab_section_tab_id","",2592e3)},formExit:function(){c.formIsSaved()?a.location.href=charitable_builder.exit_url:t.confirm({title:!1,content:"<p>"+charitable_builder.exit_confirm+"</p>",icon:"fa fa-exclamation-circle",type:"orange",closeIcon:!0,buttons:{confirm:{text:charitable_builder.save_exit,btnClass:"btn-confirm",keys:["enter"],action:function(){c.formSave(!0)}},cancel:{text:charitable_builder.exit,keys:["esc"],action:function(){o=!1,a.location.href=charitable_builder.exit_url}}}})},checkFieldMax:function(e="",a=99){0===e.length?r.$preview.find(".charitable-field-"+e).length<a&&r.$panelDesign.find("button#charitable-add-fields-"+e).removeClass("charitable-disabled"):r.$preview.find(".charitable-field[data-field-max!='']").each(function(){var e=parseInt(t(this).data("field-max")),a=t(this).data("field-type"),i=void 0===a||0===a.length?0:r.$preview.find(".charitable-field-"+a).length;!isNaN(e)&&e>0&&i>=e&&r.$panelDesign.find("button#charitable-add-fields-"+a).addClass("charitable-disabled")})},checkFieldAllow:function(){wpchar.debug("checkFieldAllow"),t.each(i.denyList,function(e,a){t.each(a,function(e,a){c.enableAddFieldButton(e)})}),t.each(i.denyList,function(e,a){wpchar.debug("fieldPresent: "+e),c.checkFieldIsPresent(e)&&t.each(a,function(e,a){(0===a||c.getFieldAmount(e)>parseInt(a))&&(wpchar.debug(e+" is not allowed"),c.disableAddFieldButton(e))})})},checkAllRecommendedFields:function(){t.each(t(".charitable-add-fields-group-recommended button"),function(){var e=t(this).data("field-type");c.checkRecommendedFields(e)})},checkRecommendedFields:function(e=!1){if(e&&0!==e.length){var a=r.$preview.find(".charitable-field[data-field-type='"+e+"']").length,t=l.find("#charitable-add-fields-"+e).parent().find(".charitable-check");void 0!==t&&0!==t.length&&(0===a?t.removeClass("checked").addClass("unchecked"):t.removeClass("unchecked").addClass("checked"))}},disableAddFieldButton:function(e){r.$panelDesign.find("button#charitable-add-fields-"+e).addClass("charitable-disabled")},enableAddFieldButton:function(e=""){r.$panelDesign.find("button#charitable-add-fields-"+e).removeClass("charitable-disabled")},getFieldAmount:function(e=""){if(0!==e.length)return r.$preview.find(".charitable-field-"+e).length},checkFieldIsPresent:function(e=""){return 0!==e.length&&c.getFieldAmount(e)>0},setCloseConfirmation:function(e){o=!!e},formIsSaved:function(){return 0===t("#charitable-builder-form input#charitable-form-saved").val().length&&void 0!==i.formSaved&&0===i.formSaved.length},setCampaignTitleNotSet:function(){t(".charitable-edit-campaign-title-label").text("Name Your Campaign:")},setCampaignTitleSet:function(){t(".charitable-edit-campaign-title-label").text("Now Editing:")},setCampaignNotSaved:function(e=!1){var a=Date.now();t("#charitable-builder-form input#charitable-form-saved").val(a),i.formSaved=a,r.$previewButton.removeClass("charitable-disabled")},setCampaignSaved:function(){t("#charitable-builder-form input#charitable-form-saved").val(""),i.formSaved="",void 0!==i.formStatus&&"publish"===i.formStatus?r.$previewButton.addClass("charitable-disabled"):r.$previewButton.removeClass("charitable-disabled")},bindUIMoneyTextFields:function(){l.on("keydown","input#charitable-panel-field-settings-campaign_minimum_donation_amount, input#charitable-panel-field-settings-campaign_goal",function(e){var a=e.keyCode||e.which;190==a||188==a||32==a||9==a||8==a||e.ctrlKey&&65==a||e.ctrlKey&&67==a||e.ctrlKey&&88==a||e.ctrlKey&&86==a||e.metaKey&&65==a||e.metaKey&&67==a||e.metaKey&&88==a||e.metaKey&&86==a||a>=96&&a<=105||110==a||190==a||a>=37&&a<=40||46==a||a>=48&&a<=57||e.preventDefault()}),l.on("focusout","input#charitable-panel-field-settings-campaign_minimum_donation_amount, input#charitable-panel-field-settings-campaign_maximum_donation_amount, input#charitable-panel-field-settings-campaign_goal",function(e){var a=t(this),i=a.val(),l=charitable_builder.currency_decimal_separator,n=charitable_builder.currency_thousands_separator;void 0!==l&&0!==l.length&&void 0!==n&&0!==n.length&&i.length>0&&-1===i.indexOf(l)&&a.val(i+l+"00")})},bindUISettingsRevealGroups:function(){t.each(r.$settingsPanel.find(".charitable-panel-fields-group.unfoldable"),function(){var e=t(this),a=e.attr("data-group");"true"!==wpCookies.get("charitable_fold_"+a)||e.hasClass("opened")||(e.addClass("opened"),e.find(".charitable-panel-fields-group-inner").show())}),r.$settingsPanel.on("click",".charitable-track-cookie",function(e){var a=t(this),i=a.closest(".unfoldable").attr("data-group");a.closest(".unfoldable").hasClass("opened")?wpCookies.remove("charitable_fold_"+i):wpCookies.set("charitable_fold_"+i,!0,2592e3)})},checkFieldConditionals:function(){t.each(charitable_campaign_builder_field_conditionals,function(e,a){var i=r.$settingsPanel.find(e),l=a;i.is('input[type="checkbox"]')&&r.$settingsPanel.on("click",e,function(e){t(this);var a=t(this).is(":checked"),i=l.checked,n=l.unchecked;a?t.each(i,function(e,a){r.$settingsPanel.find(a+"").removeClass("charitable-hidden")}):t.each(n,function(e,a){t.each(a,function(e,a){r.$settingsPanel.find(a+"").addClass("charitable-hidden")})})}),i.is('input[type="radio"]')&&r.$settingsPanel.on("click",i.closest(".charitable-panel-field-radio-options").find('input[type="radio"]'),function(e){var a=t(i).is(":checked"),n=l.checked,o=l.unchecked,d=!1;a?t.each(n,function(e,a){"if"===e&&t.each(a,function(e,a){"checked"===a&&!1===r.$settingsPanel.find(e+"").is(":checked")&&(d=!0)}),"show"===e&&!1===d?r.$settingsPanel.find(a+"").removeClass("charitable-hidden"):"show"===e&&!0===d&&r.$settingsPanel.find(a+"").addClass("charitable-hidden")}):t.each(o,function(e,a){r.$settingsPanel.find(a+"").addClass("charitable-hidden")})})})},isBuilderInPopup:function(){return a.self!==a.parent&&"charitable-builder-iframe"===a.self.frameElement.id},bindUIActionsGeneral:function(){l.on("click",".charitable-panel-fields-group.unfoldable .charitable-panel-fields-group-title",c.toggleUnfoldableGroup),l.on("click",".go-to-settings-button",function(e){e.preventDefault(),c.panelSwitch("settings");var a=t(this).data("settings-section"),i=t(".charitable-panel-sidebar-content"),l=i.find(".charitable-panel-sidebar-section"),n=i.find(".charitable-panel-sidebar-section-"+a);n.hasClass("active")||(c.panelSectionSwitchTo(a,i,l,n),wpCookies.set("charitable_panel_sidebar_section",a,2592e3))}),l.on("click","#charitable-builder-mobile-notice .charitable-fullscreen-notice-button-primary, #charitable-builder-mobile-notice .close",function(){a.location.href=charitable_builder.exit_url}),l.on("click","#charitable-builder-mobile-notice .charitable-fullscreen-notice-button-secondary",function(){a.location.href=wpchar.updateQueryString("force_desktop_view",1,a.location.href)})},initFeedbackForms:function(e){var a=e.closest(".charitable-form"),i=a.find(".charitable-feedback-form-interior-confirmation"),l={name:a.find(".charitable-feedback-form-name").val(),email:a.find(".charitable-feedback-form-email").val(),feedback:a.find(".charitable-feedback-form-feedback").val(),type:a.find(".charitable-feedback-form-type").val()};if(""===l.name||""===l.email||""===l.feedback)t.alert({title:!1,content:charitable_builder.feedback_form_fields_required,icon:"fa fa-info-circle",type:"red",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["esc"],action:function(){}}}});else{e.addClass("charitable-disabled"),a.addClass("charitable-processing"),a.find(".charitable-loading-spinner").removeClass("charitable-hidden");var n={action:"charitable_campaign_builder_send_feedback_ajax",dataType:"json",data:l,nonce:charitable_builder.nonce};t.post(charitable_builder.ajax_url,n,function(t){t.success&&(e.removeClass("charitable-disabled"),a.removeClass("charitable-processing"),a.find(".charitable-feedback-form-interior").addClass("charitable-hidden"),i.removeClass("charitable-hidden"),i.find(".charitable-form-confirmation").removeClass("charitable-hidden"))}).fail(function(e,a,t){}).always(function(){})}},toggleUnfoldableGroup:function(e){e.preventDefault();var a=t(e.target).closest(".charitable-panel-fields-group"),i=a.find(".charitable-panel-fields-group-inner"),l="charitable_fields_group_"+a.data("group");a.hasClass("opened")?(wpCookies.remove(l),i.stop().slideUp(150,function(){a.removeClass("opened")})):(wpCookies.set(l,"true",2592e3),a.addClass("opened"),i.stop().slideDown(150))},updateDebugWindow:function(e,a=0){var i={action:"charitable_update_debug_window_ajax",dataType:"json",data:e,id:a,nonce:charitable_builder.nonce};t.post(charitable_builder.ajax_url,i,function(e){e.success&&t(".charitable-debug").html(e.data)}).fail(function(e,a,t){}).always(function(){})},dismissNotice:function(){l.on("click",".charitable-alert-field-not-available .charitable-dismiss-button",function(e){e.preventDefault();var a=t(this),i=a.closest(".charitable-alert"),l=a.data("field-id");i.addClass("out"),setTimeout(function(){i.remove()},250),l&&t("#charitable-field-option-"+l).remove()})},initHTMLEditorFields:function(e,a=!1){if(-1==t.inArray(e.attr("id"),i.quilled)){var l="#"+e.attr("id"),n=e.data("textarea-name");if(!1!==a){var o=new Quill(l,{debug:"info",theme:"snow",modules:{toolbar:["bold","italic","underline","strike"]}});t(l).css("height","200px"),t(l).css("min-height","200px"),o.focus,i.quilled.push(e.attr("id"))}else{(o=new Quill(l,{theme:"snow"})).focus,i.quilled.push(e.attr("id"))}t(l).on("focus",".ql-editor",function(){var a=e.find(".ql-editor").html();"campaign_description"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(t("#charitable-panel-field-settings-campaign_description .ql-editor").html(a),r.$preview.find(".charitable-field-campaign-description .charitable-campaign-builder-placeholder-preview-text").html("<div>"+a+"</div>"),i.campaignDescription=a)}),o.on("text-change",function(l,o,d){var s=e.find(".ql-editor").html(),p=e.closest(".charitable-group-row").data("tab-id"),h=e.closest(".charitable-panel-field").data("field-id");if(c.setCampaignNotSaved(),t('input[name="'+n+'"]').val(s),"campaign_description"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(""===t.trim(c.removeTags(s))?(r.$preview.find(".charitable-campaign-builder-no-description-preview").removeClass("charitable-hidden"),r.$preview.find(".charitable-field-campaign-description .charitable-campaign-builder-placeholder-preview-text").html("<div></div>"),i.campaignDescription=""):(r.$preview.find(".charitable-field-campaign-description .charitable-campaign-builder-placeholder-preview-text").html("<div>"+s+"</div>"),i.campaignDescription=s),t("#charitable-panel-field-settings-campaign_description .ql-editor").html(s)),"campaign_overview"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(""===t.trim(c.removeTags(s))?(r.$preview.find(".charitable-campaign-builder-no-overview-preview").removeClass("charitable-hidden"),r.$preview.find(".charitable-field-campaign-overview .charitable-campaign-builder-placeholder-preview-text").html("<div></div>"),i.campaignDescription=""):(r.$preview.find(".charitable-field-campaign-overview .charitable-campaign-builder-placeholder-preview-text").html("<div>"+s+"</div>"),i.campaignDescription=s),t("#charitable-panel-field-settings-campaign_overview .ql-editor").html(s)),"organizer_content"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(h=parseInt(e.closest(".charitable-panel-field-textarea").data("field-id")),""===t.trim(c.removeTags(s))?r.$preview.find("#charitable-field-"+h+" .charitable-organizer-description").html("<div></div>"):r.$preview.find("#charitable-field-"+h+" .charitable-organizer-description").html("<div>"+s+"</div>")),"text"===e.closest(".charitable-panel-field-textarea").attr("data-special-type")&&(h=parseInt(e.closest(".charitable-panel-field-textarea").data("field-id")),""===t.trim(c.removeTags(s))?r.$preview.find("#charitable-field-"+h+" .charitable-campaign-builder-placeholder-preview-text").html("<div></div>"):r.$preview.find("#charitable-field-"+h+" .charitable-campaign-builder-placeholder-preview-text").html("<div>"+s+"</div>")),!1!==a){var b=parseInt(e.find(".ql-editor").height()/2);t("#tab_"+p+"_content .placeholder.big").css("min-height",b+"px")}})}},initSuggestedDonations:function(e){wpchar.debug(e,"initSuggestedDonations");var a=e.closest(".charitable-campaign-suggested-donations"),i=e.find("[data-charitable-add-row]"),l=(i.data("charitable-add-row"),e.find(".charitable-delete-row"));i.on("click",function(a){a.preventDefault(),a.stopImmediatePropagation();var i=t(this).data("charitable-add-row");return"suggested-amount"===i?c.add_suggested_amount_row(t(this)):"suggested-recurring-amount"===i&&c.add_suggested_amount_row(t(this),"recurring"),c.initSuggestedDonations(e),!1}),l.on("click",function(a){a.preventDefault(),a.stopImmediatePropagation();var i=t(this).closest(".charitable-campaign-suggested-donations").find("[data-charitable-add-row]").data("charitable-add-row");return"suggested-amount"===i?c.delete_suggested_amount_row(t(this)):"suggested-recurring-amount"===i&&c.delete_suggested_amount_row(t(this),"recurring"),c.initSuggestedDonations(e),!1}),t(".charitable-campaign-suggested-donations tbody").sortable({items:"tr:not(.to-copy)",handle:".handle",stop:function(e,a){c.reindex_rows(),t(".charitable-campaign-suggested-donations-mini").each(function(){c.updateSuggestdDonationsMiniRowsFromSettings(t(this)),c.redrawDonationAmountsPreview(t(this))})}}),a.on("click","th.default_amount-col a, a.charitable-clear-defaults",function(){return a.find(".default_amount-col input").prop("checked",!1),t(this).blur(),!1}),a.on("change",'input[type="radio"]',function(){c.redrawDonationAmountsPreview(a)})},updateSuggestdDonationsMiniRowsFromSettings:function(e,a=0){return 0===a&&(a=e.closest(".charitable-panel-field").data("field-id")),e.find("tbody").children("tr").not(".to-copy").remove(),t("#campaign_donation_amounts tbody").children("tr").not(".no-suggested-amounts").not(".to-copy").each(function(i){var l="",n=i+1,r=t(this).find(".amount-col input").val();l=l+'<tr class="" data-index="'+n+'">',l=(l=(l=(l+='<td class="reorder-col"><span class="charitable-icon charitable-icon-donations-grab handle ui-sortable-handle"></span></td>')+'<td class="default_amount-col"><input '+(t(this).find(".default_amount-col input").is(":checked")?"checked":"")+' type="radio" class="campaign_suggested_donations" name="_fields]['+a+'][donation_amounts][campaign_suggested_donations_default][]" value="'+n+'"></td>')+'<td class="amount-col"><input autocomplete="false" type="text" class="campaign_suggested_donations" name="_fields]['+a+"][donation_amounts]["+n+'][amount]" value="'+r+'" placeholder="Amount"></td>')+'<td class="description-col"><input type="text" class="campaign_suggested_donations" name="_fields]['+a+"][donation_amounts]["+n+'][description]" value="This is a small donation." placeholder="Optional Description">',l+="</td>",l+='<td class="remove-col"><span class="dashicons-before dashicons-dismiss charitable-delete-row"></span></td>',l+="</tr>",e.find("tbody").append(l)}),e},updateSuggestdDonationsRowsFromSettings:function(e,a){return void 0!==a&&0!==a.length||(a=t("#campaign_donation_amounts")),a.find("tbody").children("tr").not(".to-copy").remove(),e.children("tr").not(".no-suggested-amounts").not(".to-copy").each(function(e){var i="",l=e+1,n=t(this).find(".amount-col input").val();i=i+'<tr class="" data-index="'+l+'">',i=(i=(i=(i+='<td class="reorder-col"><span class="charitable-icon charitable-icon-donations-grab handle ui-sortable-handle"></span></td>')+'<td class="default_amount-col"><input '+(t(this).find(".default_amount-col input").is(":checked")?"checked":"")+' type="radio" class="campaign_suggested_donations" name="settings][donation-options][donation_amounts][campaign_suggested_donations_default][]" value="'+l+'">')+'<td class="amount-col"><input autocomplete="off" type="text" class="campaign_suggested_donations" name="settings][donation-options][donation_amounts]['+l+'][amount]" value="'+n+'" placeholder="Amount">')+'<td class="description-col"><input type="text" class="campaign_suggested_donations" name="settings][donation-options][donation_amounts]['+l+'][description]" value="This is a small donation." placeholder="Optional Description">',i+="</td>",i+='<td class="remove-col"><span class="dashicons-before dashicons-dismiss charitable-delete-row"></span></td>',i+="</tr>",a.find("tbody").append(i)}),a},initSuggestedDonationsMini:function(e){wpchar.debug(e,"initSuggestedDonationsMini"),wpchar.debug("initSuggestedDonationsMini");var a=e.closest(".charitable-panel-field").data("field-id");wpchar.debug(e,"initSuggestedDonationsMini"),c.updateSuggestdDonationsMiniRowsFromSettings(e,a),wpchar.debug(e,"initSuggestedDonationsMini2"),c.redrawDonationAmountsPreview(e),wpchar.debug(e,"initSuggestedDonationsMini3");var i=e.closest(".charitable-campaign-suggested-donations-mini");e.find("[data-charitable-add-row]").on("click",function(){return"suggested-amount"===t(this).data("charitable-add-row")&&(wpchar.debug("type is suggesetd amount"),wpchar.debug(t(this)),c.add_suggested_amount_row(t(this),"mini")),!1}),t(".charitable-campaign-suggested-donations-mini tbody").sortable({items:"tr:not(.to-copy)",handle:".handle",stop:function(e,a){wpchar.debug("sortable test mini "),c.reindex_rows("mini"),c.updateSuggestdDonationsRowsFromSettings(t(this)),c.redrawDonationAmountsPreview(t(this).parent())}}),i.on("click",".charitable-delete-row",function(){return c.delete_suggested_amount_row(t(this),"mini"),!1}),i.on("click","th.default_amount-col a",function(){return i.find(".default_amount-col input").prop("checked",!1),t(this).blur(),!1}),i.on("change",'input[type="radio"]',function(){c.redrawDonationAmountsPreview(i);var e=t(this).val();l.find(".charitable-campaign-suggested-donations-table").find('input[type="radio"]').prop("checked",!1),l.find(".charitable-campaign-suggested-donations-table").each(function(){t(this).find('input[type="radio"][value="'+e+'"]').prop("checked",!0)})})},add_suggested_amount_row:function(e,a=""){wpchar.debug("add_suggested_amount_row"),wpchar.debug(".charitable-campaign-suggested-donations"+a);("recurring"===a?l.find(".charitable-campaign-suggested-recurring-donations-table"):l.find(".charitable-campaign-suggested-donations-table")).each(function(){wpchar.debug(t(this));var e=t(this).closest("table").find("tbody"),i=e.find("tr.to-copy").clone().removeClass("to-copy hidden"),l=e.find("tr:not(.to-copy)").length+1;i.attr("data-index",l);var n=i.find('.amount-col input[type="text"].campaign_suggested_donations').attr("name").replace("[0]","["+l+"]"),r=i.find('.description-col input[type="text"].campaign_suggested_donations').attr("name").replace("[0]","["+l+"]");wpchar.debug(i.find('.amount-col input[type="text"].campaign_suggested_donations')),wpchar.debug(i.find('.amount-col input[type="text"].campaign_suggested_donations').attr("name")),i.find('.amount-col input[type="text"].campaign_suggested_donations').attr("name",n),i.find('.description-col input[type="text"].campaign_suggested_donations').attr("name",r),i.find('.default_amount-col input[type="radio"]').val(l),wpchar.debug(e,"table"),wpchar.debug(i,"clone"),e.find(".no-suggested-amounts").hide(),e.append(i),i.on("click",".charitable-delete-row",function(){return c.delete_suggested_amount_row(t(this),a),!1})}),c.redrawDonationAmountsPreview(l.find(".charitable-campaign-suggested-donations-table").first()),c.reindex_rows(a),""===a&&c.toggle_custom_donations_checkbox()},delete_suggested_amount_row:function(e,a=""){wpchar.debug("delete_suggested_amount_row"),wpchar.debug(e),wpchar.debug(a);var t=e.closest("tr "),i=parseInt(t.attr("data-index"));wpchar.debug(t),wpchar.debug(i,"row_to_delete_index");const n="recurring"===a?l.find(".charitable-campaign-suggested-recurring-donations-table"):l.find(".charitable-campaign-suggested-donations-table"),r="recurring"===a?".charitable-campaign-suggested-recurring-donations-table":".charitable-campaign-suggested-donations-table";i>0&&(wpchar.debug(n.find(' tbody tr[data-index="'+i+'"]')),wpchar.debug(r+' tbody tr[data-index="'+i+'"]'),n.find(' tbody tr[data-index="'+i+'"]').remove()),c.redrawDonationAmountsPreview(l.find(".charitable-campaign-suggested-donations-table").first());var o=e.closest("table").find("tbody");1==o.find("tr:not(.to-copy)").length&&o.find(".no-suggested-amounts").removeClass("hidden").show(),c.reindex_rows(a),""===a?c.reindex_rows("mini"):"mini"===a&&c.reindex_rows(),""===a&&c.toggle_custom_donations_checkbox()},reindex_rows:function(e=""){wpchar.debug("reindex rows with type: "+e),""!==e&&(e="-"+e),t(".charitable-campaign-suggested-donations"+e+" tbody").each(function(){t(this).children("tr").not(".no-suggested-amounts .to-copy").each(function(e){t(this).find('input[type="radio"]').val(e),t(this).attr("data-index",e),t(this).find("input").each(function(a){this.name=this.name.replace(/(\[\d\])/,"["+e+"]")})})})},redrawDonationAmountsPreview:function(e){r.$preview.find("ul.charitable-preview-donation-amounts").each(function(a){var i=t(this);i.find("li").remove(),t(e).find("tbody").children("tr").not(".no-suggested-amounts").not(".to-copy").not("hidden").each(function(e){var a=t(this).find('input[type="text"].campaign_suggested_donations').first().val(),l="";wpchar.debug(t(this).find('input[type="radio"]')),t(this).find('input[type="radio"]').is(":checked")&&(l=" selected"),i.append('<li class="charitable-preview-donation-amount suggested-donation-amount'+l+'"><label><input type="radio" name="donation_amount" value="'+e+'"><span class="amount">'+a+"</span></label></li>")}),t("#charitable-panel-field-settings-campaign_allow_custom_donations").is(":checked")&&i.append('<li class="charitable-preview-donation-amount custom-donation-amount "><span class="custom-donation-amount-wrapper"><label><input type="radio" name="donation_amount" value="custom"><span class="description">Custom amount</span></label><input type="text" disabled="&quot;true&quot;" class="custom-donation-input" name="custom_donation_amount" placeholder="Custom Donation Amount" value=""></span></li>')})},toggle_custom_donations_checkbox:function(){var e=t("#campaign_allow_custom_donations"),a=t(".charitable-campaign-suggested-donations tbody tr:not(.to-copy)"),i=a.length>1||!1===a.first().hasClass("no-suggested-amounts");e.prop("disabled",!i),i||e.prop("checked",!0)},initTagField:function(e){e.select2()},initColorPicker:function(){Coloris({el:".coloris"}),Coloris.setInstance(".instance2.primary",{defaultColor:i.primaryThemeColor,onChange:function(a){""===a?(t('input[name="layout__advanced__theme_color_primary"]').val(i.primaryThemeColorBase),i.primaryThemeColor=i.primaryThemeColorBase,e.querySelector('input[name="layout__advanced__theme_color_primary"]').dispatchEvent(new Event("input",{bubbles:!0}))):i.primaryThemeColor=a,c.updateThemeCSS("primary",i.templateID,i.primaryThemeColor,i.secondaryThemeColor,i.tertiaryThemeColor,i.buttonThemeColor,!0)},theme:"polaroid",themeMode:"light",alpha:!1,formatToggle:!0,closeButton:!0,clearButton:!0,clearLabel:"Reset",swatches:["#067bc2","#84bcda","#80e377","#ecc30b","#f37748","#d56062"]}),Coloris.setInstance(".instance2.secondary",{defaultColor:i.secondaryThemeColor,onChange:function(a){""===a?(t('input[name="layout__advanced__theme_color_secondary"]').val(i.secondaryThemeColorBase),i.secondaryThemeColor=i.secondaryThemeColorBase,c.updateThemeCSS("secondary",i.templateID,i.primaryThemeColor,i.secondaryThemeColor,i.tertiaryThemeColor,i.buttonThemeColor,!0),e.querySelector('input[name="layout__advanced__theme_color_secondary"]').dispatchEvent(new Event("input",{bubbles:!0}))):(i.secondaryThemeColor=a,c.updateThemeCSS("secondary",i.templateID,i.primaryThemeColor,i.secondaryThemeColor,i.tertiaryThemeColor,i.buttonThemeColor,!0))},theme:"polaroid",themeMode:"light",alpha:!1,formatToggle:!0,closeButton:!0,clearButton:!0,clearLabel:"Reset",swatches:["#067bc2","#84bcda","#80e377","#ecc30b","#f37748","#d56062"]}),Coloris.setInstance(".instance2.tertiary",{defaultColor:i.tertiaryThemeColor,onChange:function(a){""===a?(t('input[name="layout__advanced__theme_color_tertiary"]').val(i.tertiaryThemeColorBase),i.tertiaryThemeColor=i.tertiaryThemeColorBase,c.updateThemeCSS("teritary",i.templateID,i.primaryThemeColor,i.secondaryThemeColor,i.tertiaryThemeColor,i.buttonThemeColor,!0),e.querySelector('input[name="layout__advanced__theme_color_tertiary"]').dispatchEvent(new Event("input",{bubbles:!0}))):(i.tertiaryThemeColor=a,c.updateThemeCSS("teritary",i.templateID,i.primaryThemeColor,i.secondaryThemeColor,i.tertiaryThemeColor,i.buttonThemeColor,!0))},theme:"polaroid",themeMode:"light",alpha:!1,formatToggle:!0,closeButton:!0,clearButton:!0,clearLabel:"Reset",swatches:["#067bc2","#84bcda","#80e377","#ecc30b","#f37748","#d56062"]}),Coloris.setInstance(".instance2.button-color",{defaultColor:i.buttonThemeColor,onChange:function(a){""===a?(t('input[name="layout__advanced__theme_color_button"]').val(i.buttonThemeColorBase),i.buttonThemeColor=i.buttonThemeColorBase,c.updateThemeCSS("button",i.templateID,i.primaryThemeColor,i.secondaryThemeColor,i.tertiaryThemeColor,i.buttonThemeColor,!0),e.querySelector('input[name="layout__advanced__theme_color_button"]').dispatchEvent(new Event("input",{bubbles:!0}))):(i.buttonThemeColor=a,c.updateThemeCSS("button",i.templateID,i.primaryThemeColor,i.secondaryThemeColor,i.tertiaryThemeColor,i.buttonThemeColor,!0))},theme:"polaroid",themeMode:"light",alpha:!1,formatToggle:!0,closeButton:!0,clearButton:!0,clearLabel:"Reset",swatches:["#067bc2","#84bcda","#80e377","#ecc30b","#f37748","#d56062"]}),r.$fieldOptions.on("click",".clr-field button",function(e){e.preventDefault(),t(this).parent().find('input[type="text"]').trigger("click")})},initDatePicker:function(e){var a=e,i={dateFormat:a.data("format")||"MM d, yy",minDate:a.data("min-date")||"",beforeShow:function(e,a){setTimeout(function(){t(".ui-datepicker").css("z-index",99999999999999)},0)}};t.isFunction(a.datepicker)&&(a.datepicker(i),a.data("date")&&a.datepicker("setDate",this.$el.data("date")),a.data("min-date")&&a.datepicker("option","minDate",this.$el.data("min-date")))},trimFormTitle:function(){var e=t(".charitable-center-form-name");if(e.text().length>38){var a=e.text().trim().substring(0,38).split(" ").slice(0,-1).join(" ")+"...";e.text(a)}},builderHotkeys:function(){hotkeys("esc,ctrl+1,ctrl+2,ctrl+3,ctrl+4,ctrl+5,ctrl+s,ctrl+p,ctrl+x,ctrl+v",function(e,a){switch(a.key){case"esc":t(".charitable-builder-modal.charitable-builder-modal-template-preview").hasClass("active")&&(t(".charitable-template-list-container").removeClass("disabled"),t("#charitable-builder-underlay").remove(),t(".charitable-builder-modal.charitable-builder-modal-template-preview").removeClass("active"));break;case"ctrl+1":t(r.$templateButton,l).trigger("click");break;case"ctrl+2":t(r.$designButton,l).trigger("click");break;case"ctrl+3":t(r.$settingsButton,l).trigger("click");break;case"ctrl+4":t(r.$marketingButton,l).trigger("click");break;case"ctrl+5":t(r.$paymentButton,l).trigger("click");break;case"ctrl+s":t(r.$saveButton,l).trigger("click");break;case"ctrl+p":t(r.$previewButton,l).trigger("click");break;case"ctrl+x":t(r.$exitButton,l).trigger("click");break;case"ctrl+v":t(r.$viewCampaignButton,l).trigger("click")}})},openModalButtonClick:function(){t(e).on("click",".charitable-not-available:not(.charitable-add-fields-button)",c.openModalButtonHandler).on("mousedown",".charitable-not-available.charitable-add-fields-button",c.openModalButtonHandler),t(e).on("click",".charitable-disabled-modal:not(.charitable-add-fields-button)",c.openModalWarningModal).on("mousedown",".charitable-add-fields-button.charitable-disabled-modal",c.openModalWarningModal),t(e).on("click",".charitable-disabled-same_page:not(.charitable-add-fields-button)",c.openModalWarningModal).on("mousedown",".charitable-add-fields-button.charitable-disabled-same_page",c.openModalWarningModal),t(e).on("click",".charitable-not-installed:not(.charitable-add-fields-button)",c.openModalButtonHandlerInstall).on("mousedown",".charitable-not-installed.charitable-add-fields-button",c.openModalButtonHandlerInstall),t(e).on("click",".charitable-not-activated:not(.charitable-add-fields-button)",c.openModalButtonHandlerActivate).on("mousedown",".charitable-not-activated.charitable-add-fields-button",c.openModalButtonHandlerActivate),t(e).on("click",".charitable-addon-file-missing:not(.charitable-add-fields-button)",c.openModalButtonHandlerInstall).on("mousedown",".charitable-addon-file-missing.charitable-add-fields-button",c.openModalButtonHandlerInstall),t(e).on("click",".charitable-not-available:not(.charitable-setting-panel-upgrade-to-pro)",c.openModalButtonHandler).on("mousedown",".charitable-not-available.charitable-setting-panel-upgrade-to-pro",c.openModalButtonHandler),t(e).on("click",".charitable-need-upgrade:not(.charitable-setting-panel-upgrade-to-pro)",c.openModalButtonHandler).on("mousedown",".charitable-need-upgrade.charitable-setting-panel-upgrade-to-pro",c.openModalButtonHandler),t(e).on("click",".charitable-installed-refresh:not(.charitable-add-fields-button)",c.openModalButtonHandlerActivatedRefresh).on("mousedown",".charitable-installed-refresh.charitable-add-fields-button",c.openModalButtonHandlerActivatedRefresh),t(e).on("click","a.button-link.charitable-not-activated",c.openModalButtonHandlerActivate).on("mousedown","a.button-link.charitable-not-activated",c.openModalButtonHandlerActivate),t(e).on("click","a.button-link.charitable-not-installed",c.openModalButtonHandlerInstall).on("mousedown","a.button-link.charitable-not-installed",c.openModalButtonHandlerInstall),t(e).on("click","a.button-link.charitable-not-activated-button",c.activateFromButton).on("mousedown","a.button-link.charitable-not-activated-button",c.activateFromButton),t(e).on("click","a.button-link.charitable-not-installed-button",c.installFromButton).on("mousedown","a.button-link.charitable-not-installed-button",c.installFromButton)},activateFromButton:function(e){e.preventDefault();const a=t(this),i=t(this).data("plugin-url"),l=t(this).data("name"),n=t(this).data("settings-url"),r=t(this).data("plugin-slug"),o=t(this).data("enable-url").length>0?t(this).data("enable-url"):"";i&&l&&c.installFromButtonAjax(i,l,n,r,o,"activate","addon",a)},installFromButton:function(e){e.preventDefault();const a=t(this),i=t(this).data("plugin-url"),l=t(this).data("name"),n=t(this).data("settings-url"),r=t(this).data("plugin-slug"),o=t(this).data("enable-url").length>0?t(this).data("enable-url"):"";i&&l&&c.installFromButtonAjax(i,l,n,r,o,"install","addon",a)},installFromButtonAjax:function(e,a,i,l,n,r,o,d){wpchar.debug("setAddonState"),wpchar.debug(e),wpchar.debug(a),wpchar.debug(r);var c={activate:"charitable_activate_addon",install:"charitable_install_addon",deactivate:"charitable_deactivate_addon"}[r];if(c){var s=e;"install"===r?(n.length>0?d.text("Installing and activating gateway..."):d.text("Installing and activating..."),d.removeClass("charitable-not-installed-button"),d.addClass("charitable-view-settings-button")):"activate"===r&&(n.length>0?d.text("Activating gateway..."):d.text("Activating..."),d.removeClass("charitable-not-activated-button"),d.addClass("charitable-view-settings-button"),s=l);var p={action:c,nonce:charitable_admin.nonce,plugin:s,type:o};wpchar.debug(p),t.post(charitable_admin.ajax_url,p,function(e){("install"===r||"activate"===r)&&(t('a.button-link[data-plugin-slug="'+l+'"]').each(function(){t(this).text("View Settings"),t(this).removeClass("charitable-not-installed-button"),t(this).addClass("charitable-view-settings-button"),n.length>0?t(this).attr("href",n):t(this).attr("href",i),t(this).attr("target","_blank")}),t("section.header-content h2").addClass("charitable-hidden"),t("section.header-content h2.charitable-header-content-activated").removeClass("charitable-hidden"))}).fail(function(e){wpchar.debug(e.responseText)})}},openModalWarningModal:function(e){const a=t(this);e.preventDefault(),e.stopImmediatePropagation();let i=a.data("name"),l="",n="";a.hasClass("charitable-add-fields-button")&&(i=a.text(),i+=i.indexOf(charitable_builder.field)<0?" "+charitable_builder.field:"",a.data("field-icon")&&(l=a.data("field-icon"))),a.hasClass("charitable-disabled-modal")?n="modal":a.hasClass("charitable-disabled-same_page")&&(n="same_page"),c.modalWarningModal(i,n,l)},openModalButtonHandlerInstall:function(e){const a=t(this);var i="",l="",n="",r="";if(a.data("action")&&["activate","install"].includes(a.data("action")))return;e.preventDefault(),e.stopImmediatePropagation();let o=a.data("name");a.hasClass("charitable-add-fields-button")&&(o=a.text(),o+=o.indexOf(charitable_builder.field)<0?" "+charitable_builder.field:"",a.data("field-icon")&&(i=a.data("field-icon"))),a.data("install")?l=a.data("install"):a.data("plugin-url")&&(l=a.data("plugin-url")),a.data("video")&&(n=a.data("video")),a.data("license")&&(r=a.data("license")),c.installModal(o,l,r,n,a,!1,i)},openModalButtonHandlerActivatedRefresh:function(e){const a=t(this);e.preventDefault(),e.stopImmediatePropagation();let i=a.data("name");c.activateRefreshModal(i,a.data("video"))},openModalButtonHandlerActivate:function(e){const a=t(this);var i="",l="",n="";if(a.data("action")&&["activate","install"].includes(a.data("action")))return;e.preventDefault(),e.stopImmediatePropagation();let r=a.data("name");a.data("plugin-url")&&(i=a.data("plugin-url")),a.data("video")&&(l=a.data("video")),a.data("license")&&(n=a.data("license")),c.activateModal(r,i,n,l,a,!1,"")},openModalButtonHandler:function(e){const a=t(this);if(a.data("action")&&["activate","install"].includes(a.data("action")))return;e.preventDefault(),e.stopImmediatePropagation();let i="",l=a.data("name"),n=a.data("type");a.hasClass("charitable-add-fields-button")&&(l=a.text(),l+=l.indexOf(charitable_builder.field)<0?" "+charitable_builder.field:"",a.data("field-icon")&&(i=a.data("field-icon")));c.upgradeModal(l,"utmValue",a.data("license"),a.data("video"),n,i)},modalWarningModal:function(e,i="",l=""){var n="",r=c.getUpgradeModalWidth(!1);"modal"===i?n=charitable_builder.field_disabled_due_to_modal.replace(/%name%/g,e):"same_page"===i&&(n=charitable_builder.field_disabled_due_to_same_page.replace(/%name%/g,e));t.alert({backgroundDismiss:!0,title:"",icon:""!==l?"fa "+l:"fa fa-thumbs-up",content:n,boxWidth:r,theme:"modern,charitable-install-form",closeIcon:!0,buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){}},cancel:{text:charitable_builder.go_to_settings,btnClass:"btn-confirm",action:function(){a.open(charitable_builder.settings_page_url)}}}})},setAddonState:function(e,a,i,l,n,r,o){wpchar.debug("setAddonState"),wpchar.debug(e),wpchar.debug(a),wpchar.debug(i);var d={activate:"charitable_activate_addon",install:"charitable_install_addon",deactivate:"charitable_deactivate_addon"}[i];if(d){var c={action:d,nonce:charitable_admin.nonce,plugin:e,type:l};wpchar.debug(c),t.post(charitable_admin.ajax_url,c,function(t){o(t,e,a,i,n,r)}).fail(function(e){wpchar.debug(e.responseText)})}},callBackAddonState:function(e,a="",t="",l="",n=!1,r){wpchar.debug("callBackAddonState"),wpchar.debug(e),wpchar.debug(l),wpchar.debug(n);var o="";e.success?"install"===l?(wpchar.debug("installed"),!1!==i.currentModal&&"object"==typeof i.currentModal&&i.currentModal.close(),e.data.is_activated?(o=e.data.msg,c.upgradeModalAddonInstalledAndActivated(a,t,o)):c.upgradeModalAddonInstalledAndActivatedFailed(a,t,o)):"activate"===l?(wpchar.debug("activated"),o=e.data,!1!==i.currentModal&&"object"==typeof i.currentModal&&i.currentModal.close(),c.upgradeModalAddonActivated(a,t,o),r.addClass("charitable-installed-refresh").removeClass("charitable-not-activated"),c.openModalButtonClick()):(wpchar.debug("some other success"),o=e.data,!1!==i.currentModal&&"object"==typeof i.currentModal&&i.currentModal.close(),c.upgradeModalAddonActivated(a,t,o),r.addClass("charitable-installed-refresh").removeClass("charitable-not-activated"),c.openModalButtonClick()):(!1!==i.currentModal&&"object"==typeof i.currentModal&&i.currentModal.close(),c.upgradeModalAddonActivatedFailed(a,t,o))},activateRefreshModal:function(e,i,l=""){wpchar.debug("activateRefreshModal"),wpchar.debug(e),wpchar.debug(i);var n=charitable_builder.activated_refresh.replace(/%addon%/g,e),r=!_.isEmpty(i),o=c.getUpgradeModalWidth(r),d='<span class="charitable-upgrade-pro-title">'+e+" "+charitable_builder.activated_refresh_title+"</span>",s=t.alert({backgroundDismiss:!0,title:d,icon:""!==l?"fa "+l:"fa fa-thumbs-up",content:n,boxWidth:o,theme:"modern,charitable-activate-refresh",closeIcon:!0,buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}});t(a).on("resize",function(){o=c.getUpgradeModalWidth(r),s.isOpen()&&s.setBoxWidth(o)})},activateModal:function(e,l,n,r,o,d=!1,s=""){wpchar.debug("activatelModal"),wpchar.debug(e),wpchar.debug(l),wpchar.debug(n),wpchar.debug(r),wpchar.debug(d),void 0!==n&&0!==n.length||(n="pro");var p=charitable_builder.activate.message.replace(/%addon%/g,e),h=!_.isEmpty(r),b=c.getUpgradeModalWidth(h),u='<span class="charitable-upgrade-pro-title">'+e+" "+charitable_builder.activate.title+"</span>",m=t.alert({backgroundDismiss:!0,title:u,icon:""!==s?"fa "+s:"fa fa-thumbs-up",content:p,boxWidth:b,theme:"modern,charitable-activate-addon",closeIcon:!0,buttons:{cancel:{btnClass:"btn-confirm",keys:["esc"],isHidden:!1,isDisabled:!1,action:function(){}},install:{text:charitable_builder.activate.button,btnClass:"btn-confirm",keys:["enter"],isHidden:!1,isDisabled:!1,action:function(a){return a.setText(charitable_builder.activating),a.disable(),this.$$cancel.prop("disabled",!0),this.$$cancel.hide(),c.setAddonState(l,e,"activate","addon",t(this),o,c.callBackAddonState),!1}}}});i.currentModal=m,t(a).on("resize",function(){b=c.getUpgradeModalWidth(h),m.isOpen()&&m.setBoxWidth(b)})},installModal:function(e,l,n,r,o,d=!1,s=""){if(wpchar.debug("installModal"),wpchar.debug(e),wpchar.debug(l),wpchar.debug(n),wpchar.debug(r),wpchar.debug(o),wpchar.debug(d),void 0!==n&&0!==n.length||(n="pro"),!(t.inArray(n,["pro","basic","plus","agency","elite"])<0)){var p=charitable_builder.charitable_license_label,h=charitable_builder.install[n].message.replace(/%name%/g,p).replace(/%addon%/g,e),b=!_.isEmpty(r),u=c.getUpgradeModalWidth(b),m="";m=d?'<span class="charitable-upgrade-pro-title">'+e+" "+charitable_builder.install["pro-panel"].title+"</span>":'<span class="charitable-upgrade-pro-title">'+e+" "+charitable_builder.install[n].title+"</span>";var f=t.alert({backgroundDismiss:!1,title:m,icon:""!==s?"fa "+s:"fa fa-thumbs-up",content:h,boxWidth:u,theme:"modern,charitable-install-form",closeIcon:!1,buttons:{cancel:{btnClass:"btn-confirm",keys:["esc"],isHidden:!1,isDisabled:!1,action:function(){}},confirmInstall:{text:charitable_builder.install[n].button,btnClass:"btn-confirm",keys:["enter"],isHidden:!1,isDisabled:!1,action:function(a){return a.setText(charitable_builder.installing),a.disable(),this.$$cancel.prop("disabled",!0),this.$$cancel.hide(),c.setAddonState(l,e,"install","addon",t(this),o,c.callBackAddonState),!1}}}});i.currentModal=f,t(a).on("resize",function(){u=c.getUpgradeModalWidth(b),f.isOpen()&&f.setBoxWidth(u)})}},upgradeModal:function(e,i,l,n,r=!1,o=""){if(void 0!==l&&0!==l.length||(l="pro"),!(t.inArray(l,["pro","basic","plus","agency","elite"])<0)){var d=!_.isEmpty(n),s=c.getUpgradeModalWidth(d),p="",h="",b="",u="pro"!==l.toLowerCase()?l.charAt(0).toUpperCase()+l.slice(1):"PRO";r?(p=e+" "+charitable_builder.upgrade["pro-panel"].title.replace(/%plan%/g,u),h=(h=charitable_builder.upgrade["pro-panel"].message.replace(/%name%/g,e)).replace(/%plan%/g,u),b=(b=charitable_builder.upgrade["pro-panel"].button.replace(/%name%/g,e).replace("addon","")).replace(/%plan%/g,u)):(p=e+" "+charitable_builder.upgrade[l].title.replace(/%plan%/g,u),h=(h=charitable_builder.upgrade[l].message.replace(/%name%/g,e)).replace(/%plan%/g,u),b=(b=charitable_builder.upgrade[l].button.replace(/%name%/g,e).replace("addon","")).replace(/%plan%/g,u));var m=t.alert({backgroundDismiss:!0,title:p,icon:""!==o?"fa "+o:"fa fa-lock",content:h,boxWidth:s,theme:"modern,charitable-upgrade-form-lite",closeIcon:!0,onOpenBefore:function(){d&&this.$el.addClass("has-video");var a=d?'<iframe src="'+n+'" class="feature-video" frameborder="0" allowfullscreen="" width="475" height="267"></iframe>':"";this.$btnc.after(charitable_builder.upgrade[l].doc.replace(/%25name%25/g,e)),this.$btnc.after(a),this.$body.find(".jconfirm-content").addClass("lite-upgrade")},buttons:{confirm:{text:b,btnClass:"btn-confirm",keys:["enter"],action:function(){a.open(c.getUpgradeURL(i,l),"_blank"),c.upgradeModalThankYou(l)}}}});t(a).on("resize",function(){s=c.getUpgradeModalWidth(d),m.isOpen()&&m.setBoxWidth(s)})}},getInstallURL:function(e,a,t=!1){var i=charitable_builder.charitable_addons_page;return t&&(i=i+"&search="+t.replace(/[^0-9a-z+ ]/gi,"").replace("Field","").trim()),i},getUpgradeURL:function(e,a){var t=charitable_builder.upgrade[a].url;e.toLowerCase().indexOf("template")>-1&&(t=charitable_builder.upgrade[a].url_template);var i=/(\?)/.test(t)?"&":"?";return-1===t.indexOf("https://wpcharitable.com")&&(i=encodeURIComponent(i)),t+i+"utm_content="+encodeURIComponent(e.trim())},upgradeModalThankYou:function(e){t.alert({title:charitable_builder.thanks_for_interest,content:charitable_builder.upgrade[e].modal,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},upgradeModalAddonInstalledAndActivated:function(e="",a="",i=""){t.alert({title:'<span class="charitable-upgrade-pro-title">'+a+" "+charitable_builder.installed_activated_title+"</span>",content:charitable_builder.installed_activated_reboot,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["esc"]},saveRefresh:{text:charitable_builder.save_refresh,btnClass:"btn-confirm",keys:["enter"],action:function(e){return 0===t("#charitable_settings_title").val().length?(this.close(),c.formSaveCheck(),!1):(e.setText(charitable_builder.standby),e.disable(),this.$$confirm.prop("disabled",!0),this.$$confirm.hide(),c.formSave(!1,!1,!1,!0),!1)}}}})},upgradeModalAddonActivated:function(e="",a="",i=""){t.alert({title:'<span class="charitable-upgrade-pro-title">'+a+" "+charitable_builder.activated_title+"</span>",content:charitable_builder.activated_reboot,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["esc"]},saveRefresh:{text:charitable_builder.save_refresh,btnClass:"btn-confirm",keys:["enter"],action:function(e){return 0===t("#charitable_settings_title").val().length?(this.close(),c.formSaveCheck(),!1):(e.setText(charitable_builder.standby),e.disable(),this.$$confirm.prop("disabled",!0),this.$$confirm.hide(),c.formSave(!1,!1,!1,!0),!1)}}}})},upgradeModalAddonInstalledAndActivatedFailed:function(e="",a="",i=""){t.alert({title:'<span class="charitable-upgrade-pro-title">'+a+" "+charitable_builder.installed_activated_failed_title+"</span>",content:charitable_builder.installed_activated_failed_reboot,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},upgradeModalAddonActivatedFailed:function(e="",a="",i=""){t.alert({title:'<span class="charitable-upgrade-pro-title">'+a+" "+charitable_builder.activated_failed_title+"</span>",content:charitable_builder.activated_failed_reboot,icon:"fa fa-info-circle",type:"blue",boxWidth:"565px",buttons:{confirm:{text:charitable_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},getUpgradeModalWidth:function(e){var i=t(a).width();return i<=300?"250px":i<=750?"350px":!e||i<=1024?"560px":i>1070?"1040px":"994px"},isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)}};return c}(document,window,jQuery);CharitableCampaignBuilder.init();